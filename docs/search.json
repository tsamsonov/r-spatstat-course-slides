[
  {
    "objectID": "01_Interpolation.html#интерполяция",
    "href": "01_Interpolation.html#интерполяция",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция",
    "text": "Интерполяция\n\nИнтерполяция в общем случае — это способ нахождения промежуточных значений величины по имеющемуся дискретному набору известных значений\nМетоды которые производят интерполяцию на основе заданной аналитической зависимости, называют детерминистическими.\nПараметры этой зависимости могут быть как априори заданы пользователем, так и определяться автоматически одним из методов оптимизации"
  },
  {
    "objectID": "01_Interpolation.html#детерминистическая-интерполяция",
    "href": "01_Interpolation.html#детерминистическая-интерполяция",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Детерминистическая интерполяция",
    "text": "Детерминистическая интерполяция\n\nИнтерполяция в общем случае — это способ нахождения промежуточных значений величины по имеющемуся дискретному набору известных значений\nМетоды которые производят интерполяцию на основе заданной аналитической зависимости, называют детерминистическими.\nПараметры этой зависимости могут быть как априори заданы пользователем, так и определяться автоматически одним из методов оптимизации\nПредполагается что анализируемые данные описываются некоторой аналитической функцией \\(Z(p, \\lambda)\\), где \\(p\\) — точка, а \\(\\lambda\\) — набор внутренних параметров модели.\nЗадача: на основе известных данных \\(Z_i = Z(p_i)\\), измеренных в точках \\(p_i\\), и другой информации об исследуемом явлении подобрать набор параметров \\(\\lambda\\) и построить функцию \\(Z(p, \\lambda)\\) для всей исследуемой области \\(S\\)."
  },
  {
    "objectID": "01_Interpolation.html#узлы-интерполяции",
    "href": "01_Interpolation.html#узлы-интерполяции",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Узлы интерполяции",
    "text": "Узлы интерполяции\n\nКак правило, оценка производится по регулярной сетке узлов\nВ общем случае положение узлов интерполяции произвольно"
  },
  {
    "objectID": "01_Interpolation.html#сетка-растр-интерполяции",
    "href": "01_Interpolation.html#сетка-растр-интерполяции",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Сетка (растр) интерполяции",
    "text": "Сетка (растр) интерполяции\nКаждый узел регулярной сетки можно сопоставить с центром ячейки, что обеспечивает сплошное покрытие и позволяет построить изолинии распределения показателя"
  },
  {
    "objectID": "01_Interpolation.html#триангуляция-делоне-и-диаграмма-вороного",
    "href": "01_Interpolation.html#триангуляция-делоне-и-диаграмма-вороного",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Триангуляция Делоне и диаграмма Вороного",
    "text": "Триангуляция Делоне и диаграмма Вороного\n\n\n\n\nТриангуляция (на плоскости) — это разбиение фигуры на треугольники.\n\nПод триангуляцией множества точек понимается триангуляция их выпуклой оболочки, в которой сами точки являются вершинами треугольников.\n\nДиаграмма Вороного однозначно соответствует триангуляции Делоне и строится на основе серединных перпендикуляров к сторонам треугольников"
  },
  {
    "objectID": "01_Interpolation.html#линейные-интерполяторы",
    "href": "01_Interpolation.html#линейные-интерполяторы",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Линейные интерполяторы",
    "text": "Линейные интерполяторы\nИскомая функция в произвольной точке \\(\\mathbf{p}\\) ищется в виде линейной комбинации:\n\\[Z^{*}(\\mathbf{p}) = \\sum_{p_i \\in D(\\mathbf{p})} w_i (\\mathbf{p}) Z(\\mathbf{p}_i),\\] где:\n\n\\(Z^{*}(\\mathbf{p})\\) — оцениваемое значение в точке \\(\\mathbf{p}\\),\n\\(Z(\\mathbf{p}_i)\\) — известные значения в точках \\(\\mathbf{p}_i\\),\n\\(D(\\mathbf{p})\\) — множество точек \\(\\mathbf{p}_i\\), из некоторой окрестности точки p, определяемой расстоянием или количеством,\n\\(w_i(\\mathbf{p})\\) — нормированный вес точки \\(\\mathbf{p}_i\\) для точки \\(\\mathbf{p}\\)"
  },
  {
    "objectID": "01_Interpolation.html#метод-ближайшего-соседа",
    "href": "01_Interpolation.html#метод-ближайшего-соседа",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод ближайшего соседа",
    "text": "Метод ближайшего соседа\n\nКаждый узел интерполяции \\(p\\) получает значение, равное значению ближайшей к нему точки наблюдений \\(p_k\\)\nМножество \\(D\\) состоит из единственной точки \\(p_k (w_k = 1)\\), в полигон Вороного которой попадает точка \\(p\\).\nРезультатом является ступенчатая поверхность, где в пределах зоны влияния каждой точки \\(p_i\\) значение функции постоянно и равно \\(Z(p_i)\\)"
  },
  {
    "objectID": "01_Interpolation.html#метод-ближайшего-соседа-1",
    "href": "01_Interpolation.html#метод-ближайшего-соседа-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод ближайшего соседа",
    "text": "Метод ближайшего соседа\nВсю область интерполяции можно разбить с помощью диаграммы Вороного на зоны принадлежности к точкам наблюдений"
  },
  {
    "objectID": "01_Interpolation.html#метод-ближайшего-соседа-2",
    "href": "01_Interpolation.html#метод-ближайшего-соседа-2",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод ближайшего соседа",
    "text": "Метод ближайшего соседа\nВ пределах каждой ячейки значений интерполируемой величины считается постоянным"
  },
  {
    "objectID": "01_Interpolation.html#метод-ближайшего-соседа-3",
    "href": "01_Interpolation.html#метод-ближайшего-соседа-3",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод ближайшего соседа",
    "text": "Метод ближайшего соседа\nКаждый узел интерполяции получает значение, равное значению ближайшей к нему точки наблюдений"
  },
  {
    "objectID": "01_Interpolation.html#метод-ближайшего-соседа-4",
    "href": "01_Interpolation.html#метод-ближайшего-соседа-4",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод ближайшего соседа",
    "text": "Метод ближайшего соседа\nРезультирующая поверхность является кусочно-постоянной"
  },
  {
    "objectID": "01_Interpolation.html#метод-ближайшего-соседа-5",
    "href": "01_Interpolation.html#метод-ближайшего-соседа-5",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод ближайшего соседа",
    "text": "Метод ближайшего соседа\nРезультирующая поверхность является кусочно-постоянной"
  },
  {
    "objectID": "01_Interpolation.html#метод-естественного-соседа",
    "href": "01_Interpolation.html#метод-естественного-соседа",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод естественного соседа",
    "text": "Метод естественного соседа\nМножество \\(D\\) состоит из точек \\(p_i\\), которые являются соседями точки p при встраивании ее в диаграмму Вороного точек \\(p_i\\).\n\n\nВеса определяются из соотношения:\n\\[w_i(p) = A(v \\cap v_i) / A(v)\\]\n\n\\(v_i\\) — зона влияния точки \\(p_i\\) в исходной диаграмме Вороного,\n\\(v\\) — зона влияния точки \\(p\\) при ее встраивании в диаграмму,\n\\(A\\) — площадь зоны влияния,\n\\(\\cap\\) — пересечение"
  },
  {
    "objectID": "01_Interpolation.html#интерполяция-на-основе-триангуляции",
    "href": "01_Interpolation.html#интерполяция-на-основе-триангуляции",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция на основе триангуляции",
    "text": "Интерполяция на основе триангуляции\nДля выполнения интерполяции на первом этапе необходимо для каждого треугольника найти уравнение плоскости, которое содержит четыре неизвестных коэффициента:\n\\[Ax + By + Cz + D = 0\\]\n\\[z(x, y) = -\\frac{1}{C}(Ax+By+D)\\]\nИмея три точки \\(p_1\\), \\(p_2\\) и \\(p_3\\), искомые коэффициенты \\(A, B, C, D\\) можно получить путем решения уравнения, левая часть которого задана в форме определителя: \\[\\begin{vmatrix}\nx - x_1 & y - y_1 & z - z_1 \\\\\nx_2 - x_1 & y_2 - y_1 & z_2 - z_1 \\\\\nx_3 - x_1 & y_3 - y_1 & z_3 - z_1\n\\end{vmatrix} = 0\\]"
  },
  {
    "objectID": "01_Interpolation.html#интерполяция-на-основе-триангуляции-1",
    "href": "01_Interpolation.html#интерполяция-на-основе-триангуляции-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция на основе триангуляции",
    "text": "Интерполяция на основе триангуляции\nЛинейная интерполяция:"
  },
  {
    "objectID": "01_Interpolation.html#интерполяция-на-основе-триангуляции-2",
    "href": "01_Interpolation.html#интерполяция-на-основе-триангуляции-2",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция на основе триангуляции",
    "text": "Интерполяция на основе триангуляции\nТакже возможно применение бикубической интерполяции, или метода Акимы, который позволяет сгладить поверхность за счет применения полиномов \\(5\\)-й степени, которые содержит \\(21\\) коэффициент:\n\\[z(x, y) = \\sum_{j=0}^5 \\sum_{k=0}^{5-j} q_{jk} x^j y^k\\]\n\nЗначения функции, а также ее первых и вторых частных производных ( \\(z\\), \\(z_x\\), \\(z_y\\), \\(z_{xx}\\), \\(z_{xx}\\) и \\(z_{yy}\\)) задаются в каждой вершине треугольника, что дает \\(18\\) дополнительных условий.\nПроизводные “склеиваются” по трем сторонам между смежными треугольниками, что дает еще \\(3\\) условия."
  },
  {
    "objectID": "01_Interpolation.html#интерполяция-на-основе-триангуляции-3",
    "href": "01_Interpolation.html#интерполяция-на-основе-триангуляции-3",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция на основе триангуляции",
    "text": "Интерполяция на основе триангуляции\nМетод Акимы:"
  },
  {
    "objectID": "01_Interpolation.html#метод-обратно-взвешенных-расстояний",
    "href": "01_Interpolation.html#метод-обратно-взвешенных-расстояний",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод обратно взвешенных расстояний",
    "text": "Метод обратно взвешенных расстояний\nВеса определяются обратно пропорционально расстоянию: чем дальше исходная точка удалена, тем меньший вес она будет иметь в оценке.\n\\[z(\\mathbf{p}) = \\begin{cases}\n\\dfrac{\\sum_{i = 1}^{N}{ w_i(\\mathbf{p}) z_i } }{ \\sum_{i = 1}^{N}{ w_i(\\mathbf{p}) } }, & \\text{если } d(\\mathbf{p},\\mathbf{p}_i) \\neq 0 \\text{ для всех } i, \\\\\nz_i, & \\text{если } d(\\mathbf{p},\\mathbf{p}_i) = 0 \\text{ для одного } i,\n\\end{cases}\\]\nгде \\(w_i(\\mathbf{p}) = | \\mathbf p - \\mathbf p_i | ^{-\\beta}\\) — весовая функция.\nМетод Шепарда — одна из распространенных модификаций, в которой степень весовой функции равна \\(2\\):\n\\[w_i(p) = | \\mathbf p - \\mathbf p_i | ^{-2}\\]"
  },
  {
    "objectID": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-1",
    "href": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод обратно взвешенных расстояний",
    "text": "Метод обратно взвешенных расстояний\n\\(\\beta = 2\\)"
  },
  {
    "objectID": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-2",
    "href": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-2",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод обратно взвешенных расстояний",
    "text": "Метод обратно взвешенных расстояний\n\\(\\beta = 3\\)"
  },
  {
    "objectID": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-3",
    "href": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-3",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод обратно взвешенных расстояний",
    "text": "Метод обратно взвешенных расстояний\n\\(\\beta = 4\\)"
  },
  {
    "objectID": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-4",
    "href": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-4",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод обратно взвешенных расстояний",
    "text": "Метод обратно взвешенных расстояний\n\\(\\beta = 5\\)"
  },
  {
    "objectID": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-5",
    "href": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-5",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод обратно взвешенных расстояний",
    "text": "Метод обратно взвешенных расстояний\n\\(\\beta \\rightarrow \\infty\\)\n В предельном случае метод IDW вырождается в метод ближайшего соседа"
  },
  {
    "objectID": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-6",
    "href": "01_Interpolation.html#метод-обратно-взвешенных-расстояний-6",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Метод обратно взвешенных расстояний",
    "text": "Метод обратно взвешенных расстояний\n\\(\\beta \\rightarrow \\infty\\)\n В предельном случае метод IDW вырождается в метод ближайшего соседа"
  },
  {
    "objectID": "01_Interpolation.html#радиальные-базисные-функции",
    "href": "01_Interpolation.html#радиальные-базисные-функции",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Радиальные базисные функции",
    "text": "Радиальные базисные функции\nРадиальной функцией называется вещественнозначная функция, значение которой зависит только от расстояния между аргументом \\(\\textbf{p}\\) и некой фиксированной точкой в пространстве \\(\\textbf{c}\\):\n\\[\\phi(\\textbf{p}, \\textbf{c}) = \\phi\\big(\\lVert \\textbf{p} - \\textbf{c}\\rVert\\big)\\]\nБазисными радиальные функции называются когда их линейная комбинация используется для приближения произвольных вещественнозначных функций:\n\\[Z(\\textbf{p}) = \\sum_{i=1}^n \\lambda_i \\phi\\big(\\lVert \\textbf{p} - \\textbf{p}_i\\rVert\\big)\\]\nИменно этот принцип используется в соответствующем методе интерполяции."
  },
  {
    "objectID": "01_Interpolation.html#радиальные-базисные-функции-1",
    "href": "01_Interpolation.html#радиальные-базисные-функции-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Радиальные базисные функции",
    "text": "Радиальные базисные функции\nИспользуя условие \\(Z(\\textbf{p}_i) = z_i\\) равенства интерполированного значения исходному, получаем систему линейных уравнений следующего вида, из которой находятся искомые коэффициенты \\(\\lambda_i\\):\n\\[\\begin{equation}\n  \\begin{pmatrix}\n      z_1 \\\\\n      \\vdots\\\\\n      z_n\n  \\end{pmatrix} =\n  \\begin{pmatrix}\n      A_{11} & \\dots  & A_{1n} \\\\\n      \\vdots & \\ddots & \\vdots \\\\\n      A_{n1} & \\dots  & A_{nn}\n  \\end{pmatrix}\n  \\begin{pmatrix}\n      \\lambda_1 \\\\\n      \\vdots\\\\\n      \\lambda_n\n  \\end{pmatrix}\n\\end{equation}\\]\nгде \\(A_{ij} = \\phi\\big(\\lVert \\textbf{p}_i - \\textbf{p}_j\\rVert\\big)\\), \\(i, j = 1, 2, ..., n\\).\nЗаписав данную систему в матричном виде \\(\\mathbf{z} = \\mathbf{A} \\boldsymbol{\\lambda}\\), найти искомые коэффициенты можно путем обращения матрицы \\(\\mathbf{A}\\) (в случае если ее определитель не равен нулю):\n\\[\\boldsymbol{\\lambda} = \\mathbf{A}^{-1} \\mathbf{z}\\]"
  },
  {
    "objectID": "01_Interpolation.html#радиальные-базисные-функции-2",
    "href": "01_Interpolation.html#радиальные-базисные-функции-2",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Радиальные базисные функции",
    "text": "Радиальные базисные функции\nМетод РБФ является одним из самых гибких благодаря широким возможностям выбора радиальной функции.\nК числу широко используемых радиальных функций относятся:\n\nМультиквадрики: \\(\\phi(r) = \\sqrt{r^2 + \\delta^2}\\)\nОбратные мультиквадрики: \\(\\phi(r) = 1 / \\sqrt{r^2 + \\delta^2}\\)\nМульти-логарифмическая: \\(\\phi(r) = \\ln(r^2 + \\delta^2)\\)\nСплайны минимальной кривизны: \\(\\phi(r) = r^2 \\ln(r^2 + \\delta^2)\\)\n\n\nНедостатком метода РБФ является то, что поверхность может выходить за пределы исходного диапазона значений (хотя и обязательно проходит через исходные точки)."
  },
  {
    "objectID": "01_Interpolation.html#радиальные-базисные-функции-3",
    "href": "01_Interpolation.html#радиальные-базисные-функции-3",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Радиальные базисные функции",
    "text": "Радиальные базисные функции\nСплайн минимальной кривизны (thin plate spline — TPS), дает поверхность, обладающую максимально низкой кривизной между исходными точками."
  },
  {
    "objectID": "01_Interpolation.html#радиальные-базисные-функции-4",
    "href": "01_Interpolation.html#радиальные-базисные-функции-4",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Радиальные базисные функции",
    "text": "Радиальные базисные функции\nСплайн минимальной кривизны (thin plate spline — TPS), дает поверхность, обладающую максимально низкой кривизной между исходными точками."
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\nПусть дана область \\(\\Omega = \\big\\{(x, y)~|~0 \\leq x &lt; m,~ 0 \\leq y &lt; n \\big\\}\\) и множество точек \\(P\\) нерегулярно распределенных в этой области.\nДля выполнения интерполяции на эту область накладывается сетка \\(\\Phi\\) размером \\((m + 3) \\times (n + 3)\\). Это гарантирует, что каждая точка \\(P\\) (в том числе, находящаяся на границе \\(\\Omega\\)) будет окружена окрестностью из \\(4 \\times 4 = 16\\) узлов сетки ):\n\nРасчетная сетка поверх области исходных данных"
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-1",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\nПусть сетка \\(\\Phi\\) состоит из узлов \\(\\phi_{ij}\\) и значения индексов меняются в следующих пределах: \\(i = -1, 0, ..., m + 1, ~ j = -1, 0, ..., n + 1\\).\nТогда функция аппроксимации в узле \\(\\phi_{ij}\\) определяется следующим образом:\n\\[f(x, y) = \\sum_{k=0}^3 \\sum_{l=0}^3 B_k(s)B_l(t) \\phi_{i+k, j+l},\\]\nгде \\(i = \\lfloor x \\rfloor -1\\), \\(j = \\lfloor y \\rfloor -1\\), \\(s = x - \\lfloor x \\rfloor\\) и \\(t = y - \\lfloor y \\rfloor\\)."
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-2",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-2",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\n\\[f(x, y) = \\sum_{k=0}^3 \\sum_{l=0}^3 B_k(s)B_l(t) \\phi_{i+k, j+l},\\]\nФункции \\(B_k\\) и \\(B_l\\) представляют собой кубические базисные функции в форме B-сплайнов, определяемые как:\n\\[B_0(t) = (1-t)^3/6,\\\\\nB_1(t) = (3t^3 - 6t^2 + 4)/6,\\\\\nB_2(t) = (-3t^3 + 3t^2 + 3t + 1)/6,\\\\\nB_3(t) = t^3/6,\\]\nгде \\(0 \\leq t &lt; 1\\). Данные функции служат в качестве весовых коэффициентов соответствующих узлов при определении значения в точке \\((x, y)\\)."
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-3",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-3",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\n\\[f(x, y) = \\sum_{k=0}^3 \\sum_{l=0}^3 B_k(s)B_l(t) \\phi_{i+k, j+l},\\]\nИнтерполируемые значения \\(\\phi_{ij}\\) находятся исходя из условия прохождения функции \\(f(x, y)\\) через точки исходных данных.\nДля значения \\(z_c\\) в точке \\((x_c, y_c) ~|~ 1 \\leq x_c, y_c &lt; 2\\) условие прохождения можно записать как:\n\\[z_c = \\sum_{k=0}^3 \\sum_{l=0}^3 w_{kl} \\phi_{kl},\\]\nгде \\(w_{kl} = B_k(s) B_l(t), s = x_c - 1, t = y_c - 1\\)."
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-4",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-4",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\n\\[z_c = \\sum_{k=0}^3 \\sum_{l=0}^3 w_{kl} \\phi_{kl},\\]\nПоскольку существует множество значений \\(\\phi_{kl}\\), которые удовлетворяют приведенному соотношению, выбирается то их сочетание, которое минимизирует сумму их квадратов \\(\\sum_{k=0}^3 \\sum_{l=0}^3 \\phi^2_{kl}\\). Стратегически это позволяет уменьшить отклонение функции \\(f\\) относительно нуля по области \\(\\Omega\\).\nРешая задачу по методу наименьших квадратов, можно получить следующее выражение для значения в узле сетки \\(\\phi_{kl}\\):\n\\[\\phi_{kl} = \\frac{w_{kl} z_c}{\\sum_{a=0}^3 \\sum_{b=0}^3 w^2_{ab}}\\]\nФункция \\(f(x,y)\\), построенная таким образом, будет равна \\(z_c\\) в точке \\((x_c, y_c)\\)."
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-5",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-5",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\nВ одной окрестности может оказаться более чем одна точка:\n\nПерекрытие окрестностей (слева) и множество близких данных (справа)При расчетах вводится понятие множества близких данных (proximity dataset): только исходные точки, попадающие в окрестность \\(4 \\times 4\\) ячейки относительно расчетного узла, могут оказывать влияние на его значение."
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-6",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-6",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\nДля того, чтобы найти компромисс между значениями, индуцируемыми в узле разными точками \\(\\phi_c\\), минимизируется функция ошибки:\n\\[e(\\phi_{ij}) = \\sum_c (w_c \\phi_{ij} - w_c \\phi_c)^2.\\]\nФигурирующее в ней выражение \\(w_c \\phi_{ij} - w_c \\phi_c\\) представляет собой разницу между реальным и ожидаемым вкладом \\(\\phi_{ij}\\) в значение функции \\(f\\) в точке \\((x_c, y_c)\\). Дифференцируя \\(e(\\phi_{ij})\\) по \\(\\phi_{ij}\\), получаем итоговое выражение для значения в узле интерполяции \\(\\phi_{ij}\\):\n\\[\\phi_{ij} = \\frac{\\sum_c w_c^2 \\phi_c}{\\sum_c w_c^2}.\\]\nЕсли окрестность не содержит ни одной точки, то \\(\\phi_{ij}\\) принимается равным \\(0\\)."
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-7",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-7",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\nВ методе иерархических базисных сплайнов используется иерархия сеток \\(\\Phi_0, \\Phi_1, ..., \\Phi_h\\), наложенных на область \\(\\Omega\\).\n На каждом последующем уровне вложенности, разрешение сетки удваивается. Это означает, что:\n\nесли сетка \\(\\Phi_k\\) имела размер \\((m +3) \\times (n + 3)\\), то на уровне \\(\\Phi_{k+1}\\) ее размеры будут соответствовать \\((2m + 3) \\times (2n + 3)\\).\nрасположение узла с координатами \\((i, j)\\) на сетке \\(\\Phi_k\\) совпадает с располоожением узла \\((2i, 2j)\\) на сетке \\(\\Phi_{k+1}\\)"
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-8",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-8",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\nИнтерполяция производится последовательно в направлении увеличения детализации сетки.\n\nНа первой итерации на сетке \\(\\Phi_0\\) получают функцию \\(f_0\\) и соответствующие ей отклонения в точках исходных данных \\(\\Delta^1 z_c = z_c - f_0(x_c, y_c)\\). \nДалее на сетке \\(\\Phi_1\\) в качестве \\(f_1\\) интерполируются уже не исходные величины \\(z_c\\), а отклонения \\(\\Delta^1 z_c\\). \nСумма \\(f_0 + f_1\\) позволяет вычислить отклонения второго порядка: \\(\\Delta^2 z_c = z_c - f_0(x_c, y_c) - f_1(x_c, y_c)\\) в каждой точке \\((x_c, y_c)\\)."
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-9",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-9",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\nОбобщая данный подход, можно сказать, что на \\(k\\)-м уровне иерархии находится функция \\(f_k\\), которая аппроксимирует значения отклонения на предыдущем уровне:\n\\[\\Delta^k z_c = z_c - \\sum_{i=0}^{k-1} f_i (x_c, y_c) = \\Delta^{k-1} z_c - f_{k-1} (x_c, y_c),\\]\nгде \\(\\Delta^0 z_c = z_c\\).\nФинальные значения в узлах сетки определяются суммой функций по всем уровням иерархии:\n\\[f = \\sum_{k=0}^h f_k\\]"
  },
  {
    "objectID": "01_Interpolation.html#иерархические-базисные-сплайны-10",
    "href": "01_Interpolation.html#иерархические-базисные-сплайны-10",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Иерархические базисные сплайны",
    "text": "Иерархические базисные сплайны\nВ данном методе поверхность представляется как сумма кусочно-полиномиальных функций, определяемых на основе двумерных базисных сплайнов"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия",
    "href": "01_Interpolation.html#глобальная-регрессия",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nИспользуется для глобальной аппроксимации тренда\n\\[P_1(x, y) = a + bx + cy\\] \\[P_{1.5}(x, y) = a + bx + cy + dxy\\] \\[P_{2}(x, y) = a + bx + cy + dxy + ex^2 + fy^2\\] Неизвестные коэффициенты находятся по методу наименьших квадратов решением системы линейных уравнений относительно коэффициентов a, b и т.д. Минимизируется функция потери:\n\\[L = \\sum_{i=1}^{n} \\Large[Z(x_i, y_i) - P_k(x_i, y_i) \\Large]^2\\]"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-1",
    "href": "01_Interpolation.html#глобальная-регрессия-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nПусть дана модель линейной регрессии \\(z = X \\beta\\). Тогда полное выражение для функции потерь имеет вид:\n\\[L = \\lVert X \\beta - z \\rVert ^2 = (X \\beta - z)^T (X \\beta - z) \\\\= z^T z - z^T X \\beta - \\beta^T X^T z + \\beta^T X^T X \\beta\\] Далее находят производную этой функции:\n\\[\\frac{\\partial L}{\\partial \\beta} = \\underbrace{\\frac{\\partial (z^T z)}{\\partial \\beta}}_{0} - \\underbrace{\\frac{\\partial (z^T X \\beta)}{\\partial \\beta}}_{X^T z} - \\underbrace{\\frac{\\partial (\\beta^T X^T z)}{\\partial \\beta}}_{X^T z} + \\underbrace{\\frac{\\partial (\\beta^T X^T X \\beta)}{\\partial \\beta}}_{2 X^T X \\beta} = \\\\ = - 2X^T z + 2 X^T X \\beta,\\]"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-2",
    "href": "01_Interpolation.html#глобальная-регрессия-2",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nПроизводная второй компоненты по правилу \\(\\frac{d(\\color{red}{A^T} b)}{db} = A\\):\n\\[\\frac{\\partial (\\color{red}{z^T X} \\beta)}{\\partial \\beta} = (z^T X)^T = X^T z\\] Производная третьей компоненты по правилу \\(\\frac{d(b^t\\color{red}{A})}{db} = A\\):\n\\[\\frac{\\partial (\\beta^T \\color{red}{X^T z})}{\\partial \\beta} = X^T z\\] Производная четвертой компоненты по правилу \\(\\frac{d(b^T \\color{red}{A} b)}{db} = 2\\color{red}{A}b\\):\n\\[\\frac{\\partial (\\beta^T \\color{red}{X^T X} \\beta)}{\\partial \\beta} = 2 \\color{red}{X^T X} \\beta\\]"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-3",
    "href": "01_Interpolation.html#глобальная-регрессия-3",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nПоскольку функция потерь является неотрицательной квадратичной, ее минимум достигается в точке, где производная равняется нулю:\n\\[- 2X^T z + 2 X^T X \\beta = 0\\] Отсюда получаем:\n\\[X^T X \\beta = X^T z\\] Перенеся коэффициенты перед \\(\\beta\\) в правую часть уравнения, получаем:\n\\[\\color{red}{\\boxed{\\color{blue}{\\beta = (X^T X)^{-1} X^T z}}}\\]"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-4",
    "href": "01_Interpolation.html#глобальная-регрессия-4",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nВ общем случае уравнение полиномиальной регрессии:\n\\[z_i \\,=\\, \\beta_0 + \\beta_1 x_i + \\beta_2 x_i^2 + \\cdots + \\beta_m x_i^m + \\varepsilon_i\\  (i = 1, 2, \\dots , n)\\] Может быть переписано в матричной форме:\n\\[\\begin{bmatrix} z_1\\\\ z_2\\\\ z_3 \\\\ \\vdots \\\\ z_n \\end{bmatrix}= \\begin{bmatrix} 1 & x_1 & x_1^2 & \\dots & x_1^m \\\\ 1 & x_2 & x_2^2 & \\dots & x_2^m \\\\ 1 & x_3 & x_3^2 & \\dots & x_3^m \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ 1 & x_n & x_n^2 & \\dots & x_n^m \\end{bmatrix} \\begin{bmatrix} \\beta_0\\\\ \\beta_1\\\\ \\beta_2\\\\ \\vdots \\\\ \\beta_m \\end{bmatrix} + \\begin{bmatrix} \\varepsilon_1\\\\ \\varepsilon_2\\\\ \\varepsilon_3 \\\\ \\vdots \\\\ \\varepsilon_n \\end{bmatrix}\\]\nИли в краткой форме: \\(\\vec z = \\mathbf{X} \\vec \\beta + \\vec\\varepsilon.\\)"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-5",
    "href": "01_Interpolation.html#глобальная-регрессия-5",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nАналогичным образом для плоскости:\n\\[z_i = \\beta_0 + \\beta_1x_i + \\beta_2y_i\\] Уравнение для вычисления коэффициентов быть переписано в матричной форме:\n\\[\\begin{bmatrix} z_1\\\\ z_2\\\\ z_3 \\\\ \\vdots \\\\ z_n \\end{bmatrix}= \\begin{bmatrix} 1 & x_1 &  y_1 \\\\ 1 & x_2 &  y_2 \\\\ 1 & x_3 &  y_3 \\\\ \\vdots & \\vdots & \\vdots \\\\ 1 & x_n & y_n \\end{bmatrix} \\begin{bmatrix} \\beta_0\\\\ \\beta_1\\\\ \\beta_2\\end{bmatrix} + \\begin{bmatrix} \\varepsilon_1\\\\ \\varepsilon_2\\\\ \\varepsilon_3 \\\\ \\vdots \\\\ \\varepsilon_n \\end{bmatrix}\\]"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-6",
    "href": "01_Interpolation.html#глобальная-регрессия-6",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nДля поверхности 2-й степени:\n\\[z_i = \\beta_0 + \\beta_1 x_i + \\beta_2 y_i + \\beta_3 x_iy_i + \\beta_4 x_i^2 + \\beta_5 y_i^2\\] Уравнение для вычисления коэффициентов быть переписано в матричной форме:\n\\[\\begin{bmatrix} z_1\\\\ z_2\\\\ z_3 \\\\ \\vdots \\\\ z_n \\end{bmatrix}= \\begin{bmatrix} 1 & x_1 & y_1 & x_1y_1 & x^2_1 & y^2_1 \\\\ 1 & x_2 &  y_2 & x_2y_2 & x^2_2 & y^2_2 \\\\ 1 & x_3 & y_3 & x_3y_3 & x^2_3 & y^2_3 \\\\ \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots \\\\ 1 & x_n & y_n & x_ny_n & x^2_n & y^2_n \\end{bmatrix} \\begin{bmatrix} \\beta_0\\\\ \\beta_1\\\\ \\beta_2 \\\\ \\beta_3 \\\\ \\beta_4 \\\\ \\beta_5 \\end{bmatrix} + \\begin{bmatrix} \\varepsilon_1\\\\ \\varepsilon_2\\\\ \\varepsilon_3 \\\\ \\vdots \\\\ \\varepsilon_n \\end{bmatrix}\\]"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-7",
    "href": "01_Interpolation.html#глобальная-регрессия-7",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nПолином степени 1"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-8",
    "href": "01_Interpolation.html#глобальная-регрессия-8",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nПолином степени 2"
  },
  {
    "objectID": "01_Interpolation.html#глобальная-регрессия-9",
    "href": "01_Interpolation.html#глобальная-регрессия-9",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Глобальная регрессия",
    "text": "Глобальная регрессия\nПолином степени 3"
  },
  {
    "objectID": "01_Interpolation.html#локальная-регрессия",
    "href": "01_Interpolation.html#локальная-регрессия",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Локальная регрессия",
    "text": "Локальная регрессия\nПусть дано \\(n\\) точек исходных данных с координатами \\(x\\) (независимая переменная) и \\(y\\) (зависимая).\n Задается число \\(0 &lt; \\alpha \\leq 1\\), которое обозначает долю от общего количества точек \\(n\\), выбираемую в окрестности каждой точки для построения регрессии.\n Тогда вес, который будет иметь каждая \\(k\\)-я точка исходных данных в уравнении регрессии для \\(i\\)-й точки исходных данных будет определяться по формуле:\n\\[w_k (x_i) = W\\big((x_k - x_i)h_r^{-1}\\big),\\]\nгде \\(h_i\\) — расстояние до \\(r = [\\alpha n]\\)-го по близости соседа точки \\(x_i\\), а \\(W\\) — весовая функция."
  },
  {
    "objectID": "01_Interpolation.html#локальная-регрессия-1",
    "href": "01_Interpolation.html#локальная-регрессия-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Локальная регрессия",
    "text": "Локальная регрессия\nВесовая функция отвечает следующим условиям:\n\n\\(W(x) &gt; 0\\) если \\(|x| &lt; 1\\);\n\\(W(-x) = W(x)\\);\n\\(W(x)\\) невозрастающая функция для \\(x \\geq 0\\);\n\\(W(x) = 0\\) если \\(|x| \\geq 1\\)\n\nОдним из стандартных вариантов весовой функции является “трикубическая”:\n\\[W(x) = \\begin{cases}\n(1 - |x|^3)^3, & \\text{если } |x| &lt; 1, \\\\\n0, & \\text{если } |x| \\geq 1.\n\\end{cases}\\]\nСогласно определению весовой функции более близкие к \\(x_i\\) точки оказывают большее влияние на коэффициенты регрессии. Помимо этого за пределами расстояния \\(h_i\\) веса всех точек исходных данных будут обнуляться."
  },
  {
    "objectID": "01_Interpolation.html#локальная-регрессия-2",
    "href": "01_Interpolation.html#локальная-регрессия-2",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Локальная регрессия",
    "text": "Локальная регрессия\nСглаженная оценка \\(\\hat{y}_i\\) в точке \\(x_i\\) получается в виде полинома степени \\(d\\):\n\\[\\hat{y}_i = \\sum_{j=0}^d \\hat{\\beta}_j (x_i) x_i^j,\\]\nгде коэффициенты \\(\\hat{\\beta}_j\\) находятся методом наименьших квадратов путем минимизации ошибки:\n\\[\\sum_{k=1}^n w_k (x_i) (y_k - \\beta_0 - \\beta_1 x_k - ... - \\beta_d x_k^d)^2\\]\nПроцедура поиска коэффициентов регрессии повторяется для каждой из \\(n\\) точек."
  },
  {
    "objectID": "01_Interpolation.html#локальная-регрессия-3",
    "href": "01_Interpolation.html#локальная-регрессия-3",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Локальная регрессия",
    "text": "Локальная регрессия\nПолином степени 0 (горизонтальная плоскость)"
  },
  {
    "objectID": "01_Interpolation.html#локальная-регрессия-4",
    "href": "01_Interpolation.html#локальная-регрессия-4",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Локальная регрессия",
    "text": "Локальная регрессия\nПолином степени 1 (наклонная плоскость)"
  },
  {
    "objectID": "01_Interpolation.html#локальная-регрессия-5",
    "href": "01_Interpolation.html#локальная-регрессия-5",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Локальная регрессия",
    "text": "Локальная регрессия\nПолином степени 2"
  },
  {
    "objectID": "01_Interpolation.html#поле-потенциала",
    "href": "01_Interpolation.html#поле-потенциала",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Поле потенциала",
    "text": "Поле потенциала\nНаиболее часто метод потенциалов используется при анализе расселения. Существует 2 альтернативных подхода к расчету:\n По населенным пунктам. В этом случае каждому населенному пункту необходимо сопоставить его радиус:\n\\[V_{i} = \\frac{P_i}{r_i} + \\sum_j \\frac{P_j}{d_{ij}},\\] где \\(P_i\\) — людность \\(i\\)-го населенного пункта, \\(r_i\\) — его радиус, \\(d_{ij}\\) — расстояние между \\(i\\)-м и \\(j\\)-м населенным пунктом.\nВ этом случае вычисленные значение необходимо далее интерполировать на заданную сетку."
  },
  {
    "objectID": "01_Interpolation.html#поле-потенциала-1",
    "href": "01_Interpolation.html#поле-потенциала-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Поле потенциала",
    "text": "Поле потенциала\nНаиболее часто метод потенциалов используется при анализе расселения. Существует 2 альтернативных подхода к расчету:\n В любых произвольно заданных локациях.\n\\[V_{p} = \\sum_i \\frac{P_i}{d_{pi}},\\] В этом случае можно делать расчеты сразу на заданную сетку. При этом необходимо принудительно ограничивать минимально возможное значение \\(d\\), чтобы потенциал не стал бесконечным."
  },
  {
    "objectID": "01_Interpolation.html#интерполяция-по-ареалам",
    "href": "01_Interpolation.html#интерполяция-по-ареалам",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция по ареалам",
    "text": "Интерполяция по ареалам\nПикнофилактический (сохраняющий объем) метод Тоблера.\nСледующее условие должно выполняться для всех площадных единиц:\n\\[\\int \\int_{R_i} Z(x,y) dx dy = H_i,\\]\nгде \\(R_i\\) — \\(i\\)-я площадная единица, \\(H_i\\) — исходное значение показателя, привязанное к \\(i\\)-й единице\n\nTobler W.R. Smooth Pycnophylactic Interpolation for Geographical Regions / W.R. Tobler // Journal of the American Statistical Association. – 1979. – Vol. 74. – № 367. – P. 519."
  },
  {
    "objectID": "01_Interpolation.html#интерполяция-по-ареалам-1",
    "href": "01_Interpolation.html#интерполяция-по-ареалам-1",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция по ареалам",
    "text": "Интерполяция по ареалам\nПикнофилактический (сохраняющий объем) метод Тоблера.\n\nНаложить растровую сетку поверх площадных единиц.\nВычислить значения в ячейках путем деления величины показателя на количество ячеек, попавших внутрь единицы.\nОсреднить значения в ячейках методом плавающего окна \\(3 \\times 3\\). Обычно используется правило ладьи.\nНормировать полученные значения таким образом, чтобы их сумма внутри каждой единицы совпала с изначальной.\n\nШаги 3-4 повторяются требуемое число раз."
  },
  {
    "objectID": "01_Interpolation.html#интерполяция-по-ареалам-2",
    "href": "01_Interpolation.html#интерполяция-по-ареалам-2",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция по ареалам",
    "text": "Интерполяция по ареалам\nПикнофилактический (сохраняющий объем) метод Тоблера.\n\nИсходные данные"
  },
  {
    "objectID": "01_Interpolation.html#интерполяция-по-ареалам-3",
    "href": "01_Interpolation.html#интерполяция-по-ареалам-3",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Интерполяция по ареалам",
    "text": "Интерполяция по ареалам\nПикнофилактический (сохраняющий объем) метод Тоблера.\n\nРезультат интерполяции"
  },
  {
    "objectID": "01_Interpolation.html#библиография",
    "href": "01_Interpolation.html#библиография",
    "title": "Детерминистическая интерполяция и аппроксимация",
    "section": "Библиография",
    "text": "Библиография\n\n\n\nСамсонов Т. Е. Пространственная статистика: курс лекций"
  },
  {
    "objectID": "02_Geostatistics.html#базовые-компоненты",
    "href": "02_Geostatistics.html#базовые-компоненты",
    "title": "Геостатистика",
    "section": "Базовые компоненты",
    "text": "Базовые компоненты\n\nПространственные локации (точки) \\[\\{p_1, p_2, ..., p_n\\}\\]\nДанные в этих локациях \\[\\{Z(p_1), Z(p_2), ..., Z(p_n)\\}\\]\n\n\nОбе компоненты в общем случае являются случайными"
  },
  {
    "objectID": "02_Geostatistics.html#случайная-величина",
    "href": "02_Geostatistics.html#случайная-величина",
    "title": "Геостатистика",
    "section": "Случайная величина",
    "text": "Случайная величина\n\nСлучайной величиной \\(Z(w)\\) называется функция, которая в результате случайного события \\(w\\) принимает некоторое вещественнозначное значение.\n\n\n\nНапример, при анализе температуры водоема в отдельно взятой точке в толще воды случайной величиной (функцией) является собственно температура, а событием — та совокупность физико-химических условий, которая сложилась в данной точке в момент измерений.\n\nЭлемент случайности вносится именно событием, которое в природе может быть чрезвычайно сложной и трудно предсказуемой комбинацией факторов, в то время как случайная величина связана с событием функциональной зависимостью."
  },
  {
    "objectID": "02_Geostatistics.html#пространственная-модель",
    "href": "02_Geostatistics.html#пространственная-модель",
    "title": "Геостатистика",
    "section": "Пространственная модель",
    "text": "Пространственная модель\n\\(p \\in \\mathbb{R}^k\\) — точка в \\(k\\)-мерном Евклидовом пространстве\n\\(Z(p)\\) — случайная величина в точке \\(p\\)\nЕсли \\(p\\) меняется над индексным множеством \\(D \\subset \\mathbb{R}^k\\), то формируется случайный процесс:\n\\[\n\\{Z(p) | p \\in D\\}\n\\]\nРезультат наблюдения случайного процесса в точках \\(D\\) является реализацией случайного процесса:\n\\[\n\\{z(p) | p \\in D\\}\n\\]\n\nВ общем случае \\(D\\) и \\(Z\\) случайны и независимы"
  },
  {
    "objectID": "02_Geostatistics.html#случайный-процесс-функция",
    "href": "02_Geostatistics.html#случайный-процесс-функция",
    "title": "Геостатистика",
    "section": "Случайный процесс (функция)",
    "text": "Случайный процесс (функция)\n\nСлучайный процесс — это семейство случайных величин, индексированных некоторым параметром \\(t\\)\n\n\nНаиболее часто анализируются одномерные случайные процессы, в которых \\(t\\) — это время\nПример случайного процесса — температура не в один момент времени, а в течение некоторого промежутка времени\nПространственная статистика изучает случайные процессы, в которых \\(t\\) — это координата точки (обычно на плоскости)"
  },
  {
    "objectID": "02_Geostatistics.html#случайный-процесс-функция-1",
    "href": "02_Geostatistics.html#случайный-процесс-функция-1",
    "title": "Геостатистика",
    "section": "Случайный процесс (функция)",
    "text": "Случайный процесс (функция)\n\nВ каждой точке \\(p_i\\) существует некоторая случайная величина \\(Z(p_i)\\) — сечение случайного процесса\nПри изменении точки \\(p_i\\) наблюдаемое значение случайного процесса меняется случайным образом, поскольку определяется оно не только местоположением, но и заранее неизвестным случайным событием\nБольшинство природных явлений показывают зависимость наблюдаемых значений от их взаимного местоположения, которая проявляется в наличии корреляции значений \\(Z(\\mathbf{p})\\) и \\(Z(\\mathbf{p} + \\mathbf{h})\\), где \\(\\mathbf{h}\\) — вектор смещения между точками\nТем короче \\(h\\), тем, как правило, сильнее выражена корреляция значений"
  },
  {
    "objectID": "02_Geostatistics.html#автокорреляция",
    "href": "02_Geostatistics.html#автокорреляция",
    "title": "Геостатистика",
    "section": "Автокорреляция",
    "text": "Автокорреляция\n\n\n\n\nСтьюдент в письме Карлу Пирсону (1900):\n\n…В целом, корреляция ослабевает, если охват по времени или пространству увеличивается. Меня не покидает мысль, что было бы великим достижением установить закон, согласно которому корреляция будет ослабевать с увеличением охвата"
  },
  {
    "objectID": "02_Geostatistics.html#автокорреляция-1",
    "href": "02_Geostatistics.html#автокорреляция-1",
    "title": "Геостатистика",
    "section": "Автокорреляция",
    "text": "Автокорреляция\nБританский статистик и биолог Рональд Эйлмер Фишер изучал пространственное распределение характеристик растений на опытных площадках, будучи сотрудником Ротамстедской агрохимической станции в 1920-1930-е гг.\n\n\n\n\n\nSir Ronald Aylmer Fisher (1876-1937)\n\n\n\nСтьюдент в письме Карлу Пирсону (1900):\n\n…всестороннее подтверждение получил тот факт, что близко расположенные участки более схожи, чем удаленные, судя по данным об урожайности… следовательно, наиболее верным будет делать [выборочные] блоки максимально компактными_\n\n— «The Design of Experiments» (1935)"
  },
  {
    "objectID": "02_Geostatistics.html#пространственная-статистика",
    "href": "02_Geostatistics.html#пространственная-статистика",
    "title": "Геостатистика",
    "section": "Пространственная статистика",
    "text": "Пространственная статистика\n\nГеостатистика (geostatistics)\n\n\\(D\\) — фиксированное подмножество в \\(\\mathbb{R}^k\\)\n\\(Z(p)\\) — случайный вектор в каждой точке \\(p\\)\nИсследуется пространственное распределение\n\nСеточные данные (lattice data)\n\n\\(D\\) — фиксированное счетное подмножество точек \\(\\mathbb{R}^k\\)\n\\(Z(p)\\) — случайный вектор в каждой точке \\(p\\)\nИсследуется пространственная зависимость и гетерогенность\n\nКонфигурации точек (point patterns)\n\n\\(D\\) — счетное подмножество точек \\(\\mathbb{R}^k\\) (точечный процесс)\n\\(Z(p)\\) — константа или счетное множество (маркированный точечный процесс)\nИсследуется пространственное размещение"
  },
  {
    "objectID": "02_Geostatistics.html#математическое-ожидание",
    "href": "02_Geostatistics.html#математическое-ожидание",
    "title": "Геостатистика",
    "section": "Математическое ожидание",
    "text": "Математическое ожидание\nМатематическое ожидание — наиболее вероятная реализация случайного процесса:\n\\[\n\\operatorname E[Z(p)]=m(p)\n\\]\n\nПусть дан географический регион, в котором производятся наблюдения температуры в течение месяца.\nВ каждый момент времени мы имеем непрерывное поле температуры — реализацию случайного процесса и относящиеся к ней данные наблюдений на метеостанциях\nОсреднив данные за период наблюдений восстановим выборочное среднее поле распределения температур — оценку математического ожидания случайного процесса"
  },
  {
    "objectID": "02_Geostatistics.html#дисперсия",
    "href": "02_Geostatistics.html#дисперсия",
    "title": "Геостатистика",
    "section": "Дисперсия",
    "text": "Дисперсия\nДисперсия — мера разброса реализаций случайного процесса относительно его математического ожидания:\n\\[\n\\operatorname {Var}[Z(p)]= \\operatorname E[Z^2(p)]-m^2(p)\n\\]\n\nАналогично математическому ожиданию, дисперсия двумерного с.п. представляет собой поле распределения, значение которого в каждой точке равно дисперсии локального сечения с.п."
  },
  {
    "objectID": "02_Geostatistics.html#ковариация",
    "href": "02_Geostatistics.html#ковариация",
    "title": "Геостатистика",
    "section": "Ковариация",
    "text": "Ковариация\nКовариация — мера линейной зависимости сечений случайного процесса в двух точках \\(p_1\\) и \\(p_2\\):\n\\[\n\\operatorname {Cov}(p_1,p_2) = \\operatorname {Cov}[Z(p_1), Z(p_2)] = \\\\\\operatorname E[Z(p_1)Z(p_2)]-m(p_1)m(p_2)\n\\]\n\nНедостатком ковариации является необходимость знания математического ожидания с.п. Это условие выполняется далеко не всегда, что связано с тем что как правило приходится иметь дело только с одной реализацией с.п"
  },
  {
    "objectID": "02_Geostatistics.html#свойства-моментов-случайных-процессов",
    "href": "02_Geostatistics.html#свойства-моментов-случайных-процессов",
    "title": "Геостатистика",
    "section": "Свойства моментов случайных процессов",
    "text": "Свойства моментов случайных процессов\n\nМоменты пространственных случайных процессов являются функциями, а не константами, в отличие от моментов случайных величин.\nДавать оценку пространственной структуре явления на основе вычисленных моментов с.п. можно только при условии, что он удовлетворяет свойствам стационарности и эргодичности."
  },
  {
    "objectID": "02_Geostatistics.html#гипотеза-стационарности",
    "href": "02_Geostatistics.html#гипотеза-стационарности",
    "title": "Геостатистика",
    "section": "Гипотеза стационарности",
    "text": "Гипотеза стационарности\n\nФункции корреляции между данными зависят только от взаимного расположения точек измерений, а не от их конкретного местоположения в пространстве.\nВ этом случае пространственная корреляция определяется вектором \\(\\mathbf{h}\\) между точками.\nДля изотропного случая, когда корреляция не зависит от направления, а только от расстояния вектор \\(\\mathbf{h}\\) переходит в скаляр — расстояние \\(d\\)."
  },
  {
    "objectID": "02_Geostatistics.html#стационарность",
    "href": "02_Geostatistics.html#стационарность",
    "title": "Геостатистика",
    "section": "Стационарность",
    "text": "Стационарность\nСтационарность в строгом смысле означает что функция распределения множества случайных величин для любой комбинации точек \\({x_1, x_2,...,x_k}\\) и любого \\(k &lt; \\infty\\) остается неизменной при смещении этой комбинации на произвольный вектор \\(h\\):\n\\[\n\\operatorname P\\{Z(x_1)&lt;z_1,...,Z(x_k)&lt;z_k\\} = \\\\ \\operatorname P\\{Z(x_1 + h)&lt;z_1,...,Z(x_k + h)&lt;z_k\\}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#стационарность-1",
    "href": "02_Geostatistics.html#стационарность-1",
    "title": "Геостатистика",
    "section": "Стационарность",
    "text": "Стационарность\n\nСтационарность по другому называют однородностью в пространстве, подразумевая что явление ведет себя одинаковым образом в любой точке пространства, как бы повторяет само себя.\nЕсли с.ф. стационарна, все ее моменты будут инвариантны относительно сдвигов (то есть будут постоянны), а это означает что для их оценки можно использовать ограниченную в пространстве область.\nВ реальности же подобного рода «идеальное» поведение встречается крайне редко, поэтому используют более слабое предположение о стационарности второго порядка."
  },
  {
    "objectID": "02_Geostatistics.html#стационарность-второго-порядка",
    "href": "02_Geostatistics.html#стационарность-второго-порядка",
    "title": "Геостатистика",
    "section": "Стационарность второго порядка",
    "text": "Стационарность второго порядка\nСлучайная функция имеет имеет стационарность второго порядка, если для любых точек \\(x\\) и \\(x+h\\) в \\(R^k\\)\n\\[\n\\begin{cases}\n  \\operatorname E[Z(x)] = m \\\\\n  \\operatorname E[(Z(x)-m)(Z(x+h)-m)] = \\operatorname C(h)\n\\end{cases}\n\\]\nМатематическое ожидание с.ф. постоянно, а ковариация зависит только от вектора \\(h\\) между точками и не зависит от их абсолютного положения.\nЕсли ковариация также не зависит от направления, а только от расстояния между точками, то \\(h\\) вырождается в скаляр, а такая случайная функция является изотропной стационарной."
  },
  {
    "objectID": "02_Geostatistics.html#эргодичность",
    "href": "02_Geostatistics.html#эргодичность",
    "title": "Геостатистика",
    "section": "Эргодичность",
    "text": "Эргодичность\nСтационарная случайная функция \\(Z(x,w)\\) называется эргодической, если ее среднее по области \\(V \\subset R^k\\) сходится к математическому ожиданию \\(m(w)\\) при стремлении \\(V\\) к бесконечности:\n\\[\n\\lim_{V \\rightarrow \\infty} \\frac{1}{|V|}\\int_{V} Z(x,w)dx = m(w)\n\\]\n\\(|V|\\) обозначает меру области \\(V\\) (площадь, объем). Предполагается что сама область \\(V\\) растет во всех направлениях, и предел ее роста не зависит от ее формы.\n\nCреднее по всем возможным реализациям равно среднему отдельной безграничной в пространстве реализации."
  },
  {
    "objectID": "02_Geostatistics.html#эргодичность-1",
    "href": "02_Geostatistics.html#эргодичность-1",
    "title": "Геостатистика",
    "section": "Эргодичность",
    "text": "Эргодичность\n\nДан кувшин с песком, в котором необходимо определить долю объема, занятую содержимым.\nЗафиксируем некоторую точку \\(x\\) в системе отсчета, привязанной к кувшину, и будем его встряхивать бесконечное число раз, каждый раз фиксируя, оказалась ли точка \\(x\\) внутри песчинки (записываем 1) или же попала в свободное между ними пространство (записываем 0)\nИз серии подобных экспериментов мы сможем оценить среднее значение индикаторной функции \\(\\operatorname I(x,w)\\), которое равно вероятности попадания зерна в точку \\(x\\), и которое не зависит от \\(x\\).\nЭта вероятность и будет равна доли объема кувшина, занятой песком."
  },
  {
    "objectID": "02_Geostatistics.html#эргодичность-2",
    "href": "02_Geostatistics.html#эргодичность-2",
    "title": "Геостатистика",
    "section": "Эргодичность",
    "text": "Эргодичность\n\nАналогичный результат можно получить, если теперь зафиксировать кувшин, а точку \\(x\\) выбирать каждый раз случайным образом.\nВ первом случае берется среднее по реализациям, а во втором — среднее по пространству.\n\n\nВ реальных экспериментах приходится иметь дело со вторым случаем."
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг",
    "href": "02_Geostatistics.html#простой-кригинг",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\nДля оценки в точке \\(z_0 = z(p_0)\\) по \\(N\\) измерениям \\(z_1, ..., z_N\\) ищутся коэффициенты следующего выражения:\n\\[\nZ^* = \\sum_{i} \\lambda_i Z_i + \\lambda_0\n\\]\nКонстанта \\(\\lambda_0\\) и веса \\(\\lambda_i\\) подобираются таким образом, что минимизируется среднеквадратическая ошибка:\n\\[\n\\operatorname E\\big[(Z^* - Z_0)^2\\big],\n\\] то есть математическое ожидание квадрата отклонения оценки от реального значения в точке \\(p_0\\)."
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-1",
    "href": "02_Geostatistics.html#простой-кригинг-1",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\n\\[\nZ^* = \\sum_{i} \\lambda_i Z_i + \\lambda_0\n\\]\nИспользуя соотношение \\(\\operatorname {Var}[X] = \\operatorname E[X^2] - (\\operatorname E[X])^2\\), можно выразить среднюю квадратическую ошибку как:\n\\[\n\\operatorname E\\big[(Z^* - Z_0)^2\\big] = \\operatorname{Var}[Z^* - Z_0] + (\\operatorname E[Z^* - Z_0])^2\n\\]\nПоскольку дисперсия нечувствительна к сдвигам, изменение константы \\(\\lambda_0\\) влияет только на компоненту \\(\\operatorname E[Z^* - Z_0]\\). Приравняем ее нулю:\n\\[\n\\operatorname E[Z^* - Z_0] = \\operatorname E\\Big[\\sum_{i} \\lambda_i Z_i + \\lambda_0 - Z_0\\Big] = 0\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-2",
    "href": "02_Geostatistics.html#простой-кригинг-2",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\n\\[\n\\operatorname E[Z^* - Z_0] = \\operatorname E\\Big[\\sum_{i} \\lambda_i Z_i + \\lambda_0 - Z_0\\Big] = 0\n\\]\nПоскольку \\(\\lambda_0\\) явялется константой, то по свойству мат. ожидания ее можно вынести за скобки:\n\\[\n\\lambda_0 = -\\operatorname E\\Big[\\sum_{i} \\lambda_i Z_i - Z_0\\Big] = m_0 - \\sum_i \\lambda_i m_i,\n\\]\nгде \\(m_i\\) — известные значения мат. ожиданий случайной функции в каждой точке исходных данных, \\(m_0\\) — известное мат. ожидание в интерполируемой точке."
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-3",
    "href": "02_Geostatistics.html#простой-кригинг-3",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\nИмея:\n\\[\nZ^* = \\sum_{i} \\lambda_i Z_i + \\lambda_0,\\\\\n\\lambda_0 = m_0 - \\sum_i \\lambda_i m_i,\n\\]\nПолучаем:\n\\[\nZ^* = \\sum_{i} \\lambda_i Z_i + m_0 - \\sum_i \\lambda_i m_i = \\\\\nm_0 + \\sum_{i} \\lambda_i (Z_i - m_i)\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-4",
    "href": "02_Geostatistics.html#простой-кригинг-4",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\n\\[\nZ^* = m_0 + \\sum_{i} \\lambda_i (Z_i - m_i)\n\\]\nПоскольку константа \\(m_0\\) известна заранее, задачу оценки можно выполнить для переменной \\(Y(p) = Z(p) - m(p)\\), используя линейную оценку\n\\[\nY^* = \\sum_{i} \\lambda_i Y_i,\n\\]\nи прибавляя к полученному результату \\(m_0\\).\nОсновной вопрос заключается в нахождении коэффициентов \\(\\lambda_i\\)."
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-5",
    "href": "02_Geostatistics.html#простой-кригинг-5",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\nПоскольку мы показали, что компонента \\(\\operatorname E[Z^* - Z_0]\\) может быть приравнена нулю, среднеквадратическая ошибка равна дисперсии:\n\\[\n\\operatorname E\\big[(Z^* - Z_0)^2\\big] = \\operatorname{Var}[Z^* - Z_0]\n\\]\nИспользуя свойства:\n\n\\(\\operatorname{Var}[X + Y] = \\operatorname{Var}[X] + \\operatorname{Var}[Y] + 2 \\operatorname{Cov}[X, Y]\\),\n\n\\(\\operatorname{Var}[-X] = \\operatorname{Var}[X]\\),\n\\(\\operatorname{Cov}[X, -Y] = -\\operatorname{Cov}[X, Y]\\), получаем:\n\n\\[\n\\operatorname{Var}[Z^* - Z_0] = \\operatorname{Var}[Z^*] + \\operatorname{Var}[Z_0] - 2 \\operatorname{Cov}[Z^*, Z_0]\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-6",
    "href": "02_Geostatistics.html#простой-кригинг-6",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\n\\[\n\\operatorname{Var}[Z^* - Z_0] = \\operatorname{Var}[Z^*] + \\operatorname{Var}[Z_0] - 2 \\operatorname {Cov}[Z^*, Z_0]\n\\]\nРаспишем компоненты этого выражения в терминах ковариации.\nПусть \\(X_1,\\ldots, X_n\\) случайные величины, а \\(Y_1 = \\sum\\limits_{i=1}^n a_i X_i,\\; Y_2 = \\sum\\limits_{j=1}^m b_j X_j\\) — их две произвольные линейные комбинации. Тогда:\n\\[\n\\operatorname {Cov}[Y_1,Y_2] = \\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m a_i b_j \\operatorname {Cov}[X_i,X_j]\\]."
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-7",
    "href": "02_Geostatistics.html#простой-кригинг-7",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\n\\[\n\\operatorname{Var}[Z^* - Z_0] = \\operatorname{Var}[Z^*] + \\operatorname{Var}[Z_0] - 2 \\operatorname{Cov}[Z^*, Z_0]\n\\]\nРаспишем компоненты этого выражения в терминах ковариации.\n\\(\\operatorname{Var}[Z^*] = \\operatorname{Cov}[Z^*, Z^*] = \\operatorname{Cov}\\Big[\\sum_{i} \\lambda_i Z_i, \\sum_{j} \\lambda_j Z_j\\Big] = \\\\ \\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\operatorname{Cov}[Z_i, Z_j] = \\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij}\\)\n\\(\\operatorname{Var}[Z_0] = \\operatorname{Cov}[Z_0, Z_0] = \\sigma_{00}\\)\n\\(\\operatorname{Cov}[Z^*, Z_0] = \\operatorname{Cov}\\Big[\\sum_{i} \\lambda_i Z_i, Z_0\\Big] =\\\\ \\sum_{i} \\lambda_i \\operatorname{Cov}[Z_i, Z_0] = \\sum_{i} \\lambda_i \\sigma_{i0}\\)"
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-8",
    "href": "02_Geostatistics.html#простой-кригинг-8",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\nТаким образом, выражение для ошибки\n\\[\n\\operatorname{Var}[Z^* - Z_0] = \\operatorname{Var}[Z^*] + \\operatorname{Var}[Z_0] - 2 \\operatorname{Cov}[Z^*, Z_0]\n\\]\nТрансформируется в\n\\[\n\\operatorname{Var}[Z^* - Z_0] = \\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij} - 2 \\sum_{} \\lambda_i \\sigma_{i0} + \\sigma_{00}\n\\]\nДля нахождения минимума этой квадратичной функции необходимо приравнять нулю ее производные по основной переменной \\(\\lambda\\). Выберем в качестве «жертвы» коэффициенты с индексом \\(i\\):\n\\[\n\\frac{\\partial}{\\partial \\lambda_i} \\operatorname E\\big[(Z^* - Z_0)^2\\big] = 2 \\sum_{j} \\lambda_j \\sigma_{ij} - 2 \\sigma_{i0} = 0\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#простой-кригинг-9",
    "href": "02_Geostatistics.html#простой-кригинг-9",
    "title": "Геостатистика",
    "section": "Простой кригинг",
    "text": "Простой кригинг\n\\[\n\\frac{\\partial}{\\partial \\lambda_i} \\operatorname E\\big[(Z^* - Z_0)^2\\big] = 2 \\sum_{j} \\lambda_j \\sigma_{ij} - 2 \\sigma_{i0} = 0\n\\]\nТаким образом, система уравнений простого кригинга для точки \\(Z_0\\) имеет вид:\n\\[\n\\color{red}{\\boxed{\\color{blue}{\\sum_{j} \\lambda_j \\sigma_{ij} = \\sigma_{i0}\\color{gray}{,~i = 1,...,N}}}}\n\\]\n\nУравнения простого кригинга носят чисто теоретический характер. На практике используется метод обычного кригинга, в котором знание среднего значения случайной функции не требуется."
  },
  {
    "objectID": "02_Geostatistics.html#дисперсия-простого-кригинга",
    "href": "02_Geostatistics.html#дисперсия-простого-кригинга",
    "title": "Геостатистика",
    "section": "Дисперсия простого кригинга",
    "text": "Дисперсия простого кригинга\nСуществует возможность оценить в каждой точке не только величину показателя, но также дисперсию оценки (в случае постоянного мат. ожидания — среднеквадратическую ошибку).\nДля этого необходимо коэффициенты \\(\\lambda_i\\), полученные из системы уравнения простого кригинга\n\\[\n\\sum_{j} \\lambda_j \\sigma_{ij} = \\sigma_{i0}\n\\]\nподставить в выражение среднеквадратической ошибки\n\\[\n\\operatorname{Var}[Z^* - Z_0] = \\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij} - 2 \\sum_{} \\lambda_i \\sigma_{i0} + \\sigma_{00}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#дисперсия-простого-кригинга-1",
    "href": "02_Geostatistics.html#дисперсия-простого-кригинга-1",
    "title": "Геостатистика",
    "section": "Дисперсия простого кригинга",
    "text": "Дисперсия простого кригинга\nУмножим обе части каждого уравнения простого кригинга на \\(\\lambda_i\\) и просуммируем все уравнения по \\(i\\):\n\\[\n\\sum_{j} \\lambda_j \\sigma_{ij} = \\sigma_{i0}~\\Bigg|\\times \\lambda_i\\\\\n\\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij} = \\sum_{i}\\lambda_i\\sigma_{i0}\n\\]\nЗаметим, что левая часть уравнения присутствует в выражении среднеквадратической ошибки:\n\\[\n\\operatorname{Var}[Z^* - Z_0] = \\color{red}{\\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij}} - 2 \\sum_{} \\lambda_i \\sigma_{i0} + \\sigma_{00}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#дисперсия-простого-кригинга-2",
    "href": "02_Geostatistics.html#дисперсия-простого-кригинга-2",
    "title": "Геостатистика",
    "section": "Дисперсия простого кригинга",
    "text": "Дисперсия простого кригинга\nЗаменим \\(\\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij}\\) на \\(\\sum_{i}\\lambda_i\\sigma_{i0}\\) в выражении для СКО:\n\\[\n\\operatorname{Var}[Z^* - Z_0] = \\color{red}{\\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij}} - 2 \\sum_{} \\lambda_i \\sigma_{i0} + \\sigma_{00} =\\\\\n\\sum_{i}\\lambda_i\\sigma_{i0} - 2 \\sum_{} \\lambda_i \\sigma_{i0} + \\sigma_{00}\n\\]\nОтсюда получаем выражение для дисперсии (ошибки) простого кригинга:\n\\[\n\\color{red}{\\boxed{\\color{blue}{\\sigma_{SK} = \\operatorname{Var}[Z^* - Z_0] = \\sigma_{00} - \\sum_{i}\\lambda_i\\sigma_{i0}}}}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#библиография",
    "href": "02_Geostatistics.html#библиография",
    "title": "Геостатистика",
    "section": "Библиография",
    "text": "Библиография\n\n\n\nСамсонов Т. Е. Пространственная статистика: курс лекций"
  },
  {
    "objectID": "02_Geostatistics.html#стационарность-приращений",
    "href": "02_Geostatistics.html#стационарность-приращений",
    "title": "Геостатистика",
    "section": "Стационарность приращений",
    "text": "Стационарность приращений\nСтационарность второго порядка требует знания математического ожидания для вычисления ковариации. В ряде случаев оценить математическое ожидание оказывается невозможно (оно может не существовать) или же оно действительно оказывается непостоянным.\nТогда пользуются еще более мягкой формой стационарности — стационарностью приращений, при которой стационарной предполагается не сама с.ф. \\(Z(x)\\), а производная от нее функция:\n\\[Y_h(x) = Z(x+h)-Z(x)\\]\nФункция \\(Z(x)\\), обладающая таким свойством, называется подчиняющейся внутренней гипотезе."
  },
  {
    "objectID": "02_Geostatistics.html#стационарность-приращений-1",
    "href": "02_Geostatistics.html#стационарность-приращений-1",
    "title": "Геостатистика",
    "section": "Стационарность приращений",
    "text": "Стационарность приращений\nУ функции \\(Y_h(x) = Z(x+h)-Z(x)\\) должны существовать математическое ожидание и дисперсия приращений:\n\\[\n\\begin{cases}\n\\operatorname E[Z(x+h)-Z(x)] = \\langle a,h \\rangle \\\\\n\\operatorname {Var}[Z(x+h)-Z(x)] = 2\\gamma(h)\n\\end{cases}\n\\]\n\n\\(\\langle a,h \\rangle\\) обозначает линейный тренд \\(a\\) при заданном векторе \\(h\\) (математическое ожидание разности значений), который выражается через скалярное произведение: \\(\\langle a,h \\rangle = \\sum_i a_i h_i\\)\n\\(\\gamma(h)\\) — дисперсия приращений, называемая вариограммой"
  },
  {
    "objectID": "02_Geostatistics.html#стационарность-приращений-2",
    "href": "02_Geostatistics.html#стационарность-приращений-2",
    "title": "Геостатистика",
    "section": "Стационарность приращений",
    "text": "Стационарность приращений\n\\[\n\\begin{cases}\n\\operatorname E[Z(x+h)-Z(x)] = \\langle a,h \\rangle \\\\\n\\operatorname {Var}[Z(x+h)-Z(x)] = 2\\gamma(h)\n\\end{cases}\n\\]\nЕсли процесс подчиняется гипотезе стационарности второго рода \\(\\operatorname E[Z(x)] = m\\), то \\(\\operatorname E[Z(x+h)-Z(x)] = \\operatorname E[Y_h(x)] = 0\\) и вариограмму можно выразить следующим образом:\n\\[\n2\\gamma(h) = \\operatorname {Var}[Z(x+h)-Z(x)] = \\operatorname {Var}[Y_h(x)] \\\\= \\operatorname E\\big[Y_h(x)\\big]^2 - \\Big(\\operatorname E\\big[Y_h(x)\\big]\\Big)^2 \\\\= \\operatorname E\\big[Y_h(x)\\big]^2 = \\operatorname E\\big[Z(x+h)-Z(x)\\big]^2\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#стационарность-приращений-3",
    "href": "02_Geostatistics.html#стационарность-приращений-3",
    "title": "Геостатистика",
    "section": "Стационарность приращений",
    "text": "Стационарность приращений\nТаким образом, наиболее распространенная в геостатистике гипотеза подчиняется следующим условиям:\n\\[\n\\begin{cases}\n\\operatorname E\\big[Z(x)\\big] = m\\\\\n\\operatorname E\\big[Z(x+h)-Z(x)\\big] = 0 \\\\\n\\operatorname E\\big[Z(x+h)-Z(x)\\big]^2 = 2\\gamma(h)\n\\end{cases}\n\\]\n\nЭти условия позволяют избавиться от необходимости знания среднего значения и дисперсии случайной функции и использовать для вычислений вариограмму.\nЧтобы модифицировать соответствующим образом уравнения простого кригинга, необходимо знать связь между ковариацией и вариограммой."
  },
  {
    "objectID": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-4",
    "href": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-4",
    "title": "Геостатистика",
    "section": "Переход от ковариации к вариограмме",
    "text": "Переход от ковариации к вариограмме\nПодставим полученное выражение в двойную сумму:\n\\[\n\\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\operatorname {Cov} \\big[Z(x_{\\alpha}) - Z(x_0), Z(x_{\\beta}) - Z(x_0)\\big] = \\\\\n= - \\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\gamma(x_{\\beta} - x_{\\alpha}),\n\\]\n\n\\(\\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\gamma(x_{\\alpha} - x_0) = \\color{blue}{\\underbrace{\\sum_{\\beta=1}^M \\mu_{\\beta}}_0} \\sum_{\\alpha=1}^N \\lambda_{\\alpha} \\gamma(x_{\\alpha} - x_0) = 0\\)\n\\(\\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\gamma(x_{\\beta} - x_0) = \\color{red}{\\underbrace{\\sum_{\\alpha=1}^N \\lambda_{\\alpha}}_0} \\sum_{\\beta=1}^M \\mu_{\\beta} \\gamma(x_{\\beta} - x_0) = 0\\)"
  },
  {
    "objectID": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме",
    "href": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме",
    "title": "Геостатистика",
    "section": "Переход от ковариации к вариограмме",
    "text": "Переход от ковариации к вариограмме\nРассмотрим ковариацию двух линейных комбинаций с.ф.:\n\\[\n\\operatorname {Cov} \\Bigg[\\sum_{\\alpha=1}^N \\lambda_{\\alpha} Z(x_{\\alpha}), \\sum_{\\beta=1}^M \\mu_{\\beta} Z(x_{\\beta}) \\Bigg] = \\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\operatorname C(x_{\\beta} - x_{\\alpha})\n\\]\nИспользуя правило \\(\\operatorname {Cov}[X + \\alpha, Y + \\beta] = \\operatorname {Cov}[X, Y]\\), введем условное начало координат:\n\\[\n\\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\operatorname C(x_{\\beta} - x_{\\alpha}) =\\\\\n=\\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\operatorname {Cov} \\big[Z(x_{\\alpha}) - Z(x_0), Z(x_{\\beta}) - Z(x_0)\\big]\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-1",
    "href": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-1",
    "title": "Геостатистика",
    "section": "Переход от ковариации к вариограмме",
    "text": "Переход от ковариации к вариограмме\nРаспишем ковариацию через математические ожидания, учитывая, что, согласно гипотезе, \\(\\operatorname E\\big[Z(x+h)-Z(x)\\big] = 0\\):\n\\[\n\\operatorname {Cov} \\big[Z(x_{\\alpha}) - Z(x_0), Z(x_{\\beta}) - Z(x_0)\\big] =\\\\\n= \\operatorname E\\big[Z_{\\alpha} - Z_0\\big]\\big[Z_{\\beta} - Z_0\\big] - \\operatorname E\\big[Z_{\\alpha} - Z_0\\big] \\operatorname E\\big[Z_{\\beta} - Z_0\\big] = \\\\\n= \\operatorname E\\big[Z_{\\alpha} - Z_0\\big]\\big[Z_{\\beta} - Z_0\\big]\n\\]\nОбратим внимание, что произведение приращений можно выразить через квадраты приращений:\n\\[\n\\color{blue}{(Z_{\\beta} - Z_{\\alpha})^2} = \\big[(Z_{\\beta} - Z_0) - (Z_{\\alpha} - Z_0)\\big]^2 = \\\\ = \\color{blue}{(Z_{\\alpha} - Z_0)^2} - 2\\color{red}{(Z_{\\alpha} - Z_0)(Z_{\\beta} - Z_0)} + \\color{blue}{(Z_{\\beta} - Z_0)^2}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-2",
    "href": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-2",
    "title": "Геостатистика",
    "section": "Переход от ковариации к вариограмме",
    "text": "Переход от ковариации к вариограмме\nИмеем:\n\\[\n(Z_{\\alpha} - Z_0)(Z_{\\beta} - Z_0) = \\frac{1}{2} \\Big[(Z_{\\alpha} - Z_0)^2 + (Z_{\\beta} - Z_0)^2 - (Z_{\\beta} - Z_{\\alpha})^2\\Big]\n\\]\nУчитывая, что \\(\\operatorname E\\big[Z(x+h)-Z(x)\\big]^2 = 2\\gamma(h)\\), подставим это выражение в формулу вычисления ковариации:\n\\[\n\\operatorname {Cov} \\big[Z(x_{\\alpha}) - Z(x_0), Z(x_{\\beta}) - Z(x_0)\\big] = \\operatorname E\\big[Z_{\\alpha} - Z_0\\big]\\big[Z_{\\beta} - Z_0\\big] = \\\\\n= \\frac{1}{2} \\operatorname E \\Big[(Z_{\\alpha} - Z_0)^2 + (Z_{\\beta} - Z_0)^2 - (Z_{\\beta} - Z_{\\alpha})^2\\Big] = \\\\\n= \\gamma(x_{\\alpha} - x_0) + \\gamma(x_{\\beta} - x_0) - \\gamma(x_{\\beta} - x_{\\alpha})\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-3",
    "href": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-3",
    "title": "Геостатистика",
    "section": "Переход от ковариации к вариограмме",
    "text": "Переход от ковариации к вариограмме\nПодставим полученное выражение в двойную сумму:\n\\[\n\\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\operatorname {Cov} \\big[Z(x_{\\alpha}) - Z(x_0), Z(x_{\\beta}) - Z(x_0)\\big] = \\\\\n= \\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\big[\\gamma(x_{\\alpha} - x_0) + \\gamma(x_{\\beta} - x_0) - \\gamma(x_{\\beta} - x_{\\alpha})\\big] = \\\\\n= \\color{blue}{\\underbrace{\\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\gamma(x_{\\alpha} - x_0)}_0} + \\color{red}{\\underbrace{\\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\gamma(x_{\\beta} - x_0)}_0} - \\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\gamma(x_{\\beta} - x_{\\alpha}) = \\\\\n= - \\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\gamma(x_{\\beta} - x_{\\alpha}),\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-5",
    "href": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-5",
    "title": "Геостатистика",
    "section": "Переход от ковариации к вариограмме",
    "text": "Переход от ковариации к вариограмме\nВ линейных комбинациях приращений сумма коэффициентов всегда равна \\(0\\), поскольку это справедливо для каждого приращения.\nДля \\(\\alpha = 1\\):\n\\[\n\\lambda_1 (x_1 - x_0) = \\lambda_1 x_1 - \\lambda_1 x_0 = \\sum_{k=0}^1 \\rho_k x_k,\n\\]\nгде \\(\\rho_0 = -\\lambda_1\\), \\(\\rho_1 = \\lambda_1\\). Следовательно:\n\\[\n\\sum_{k=0}^1 \\rho_k = 0\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#обычный-кригинг",
    "href": "02_Geostatistics.html#обычный-кригинг",
    "title": "Геостатистика",
    "section": "Обычный кригинг",
    "text": "Обычный кригинг\nПусть дано неизвестное среднее \\(m = a_0\\). Необходимо произвести линейную оценку \\(Z^* = \\sum_{i} \\lambda_i Z_i + \\lambda_0\\). Выразим среднюю квадратическую ошибку:\n\\[\n\\operatorname E\\big[(Z^* - Z_0)^2\\big] = \\operatorname {Var}[Z^* - Z_0] + \\big(E[Z^* - Z_0]\\big)^2 =\\\\\n= \\operatorname {Var}[Z^* - Z_0] + \\Bigg[\\lambda_0 + \\bigg(\\sum_i \\lambda_i - 1 \\bigg) a_0 \\Bigg]^2\n\\]\n\nТолько компонента сдвига \\(\\operatorname E[Z^* - Z_0]\\) содержит \\(\\lambda_0\\), однако, в отличие от случая простого кригинга, мы не можем минимизировать ее, не зная \\(a_0\\).\nЕдинственный способ избавиться от \\(a_0\\) заключается в том, чтобы наложить дополнительное условие \\(\\sum \\lambda_i - 1 = 0\\)"
  },
  {
    "objectID": "02_Geostatistics.html#обычный-кригинг-1",
    "href": "02_Geostatistics.html#обычный-кригинг-1",
    "title": "Геостатистика",
    "section": "Обычный кригинг",
    "text": "Обычный кригинг\nМинимизируем ранее введенную функцию ошибки:\n\\[\n\\operatorname {Var}[Z^* - Z_0] = \\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij} - 2 \\sum_{} \\lambda_i \\sigma_{i0} + \\sigma_{00}\n\\]\nДля этого, с учетом дополнительного условия \\(\\sum \\lambda_i - 1 = 0\\) применим метод множителей Лагранжа и построим вспомогательную функцию:\n\\[\nQ = \\operatorname {Var}[Z^* - Z_0] + 2\\mu \\bigg(\\sum_i \\lambda_i - 1 \\bigg),\n\\]\nгде \\(\\mu\\) – неизвестный множитель Лагранжа."
  },
  {
    "objectID": "02_Geostatistics.html#обычный-кригинг-2",
    "href": "02_Geostatistics.html#обычный-кригинг-2",
    "title": "Геостатистика",
    "section": "Обычный кригинг",
    "text": "Обычный кригинг\n\\[\nQ = \\operatorname {Var}[Z^* - Z_0] + 2\\mu \\bigg(\\sum_i \\lambda_i - 1 \\bigg)\\]\nДля минимизации функции приравняем нулю ее частные производные:\n\\[\n\\begin{cases}\\frac{\\partial Q}{\\partial \\lambda_i} = 2 \\sum_j \\lambda_j \\sigma_{ij} - 2 \\sigma_{i0} + 2\\mu = 0,~i = 1,...,N,\\\\\n\\frac{\\partial Q}{\\partial \\mu} = 2\\bigg(\\sum_i \\lambda_i - 1 \\bigg) = 0\n\\end{cases}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#обычный-кригинг-3",
    "href": "02_Geostatistics.html#обычный-кригинг-3",
    "title": "Геостатистика",
    "section": "Обычный кригинг",
    "text": "Обычный кригинг\nИмеем \\(N + 1\\) уравнений с \\(N + 1\\) неизвестными:\n\\[\n\\begin{cases}\\sum_j \\lambda_j \\sigma_{ij} + \\mu = \\sigma_{i0},~i = 1,...,N,\\\\\n\\sum_i \\lambda_i = 1\n\\end{cases}\n\\]\nЗаменяя ковариацию на вариограмму, получаем систему уравнений обычного кригинга:\n\\[\n\\color{red}{\\boxed{\\color{blue}{\\begin{cases}\\sum_j \\lambda_j \\gamma_{ij} - \\mu = \\gamma_{i0},\\color{gray}{~i = 1,...,N,}\\\\\n\\sum_i \\lambda_i = 1\n\\end{cases}}}}\n\\]\n\nЭто наиболее часто используемый в геостатистике метод оценки"
  },
  {
    "objectID": "02_Geostatistics.html#дисперсия-обычного-кригинга",
    "href": "02_Geostatistics.html#дисперсия-обычного-кригинга",
    "title": "Геостатистика",
    "section": "Дисперсия обычного кригинга",
    "text": "Дисперсия обычного кригинга\nВывод формулы для оценки дисперсии обычного кригинга выполняется аналогично случаю простого кригинга. Умножим \\(N\\) первых уравнений на \\(\\lambda_i\\), просуммируем их по \\(i\\):\n\\[\n\\sum_j \\lambda_j \\gamma_{ij} - \\mu = \\gamma_{i0}~\\Bigg|\\times \\lambda_i\n\\]\nУчтя дополнительное условие \\(\\sum_i \\lambda_i = 1\\), получаем выражение для оценки дисперсии (ошибки) обычного кригинга:\n\\[\n\\color{red}{\\boxed{\\color{blue}{\\sigma_{OK} = \\operatorname {Var}[Z^* - Z_0] = \\sum_{i}\\lambda_i\\gamma_{i0} - \\mu}}}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг",
    "href": "02_Geostatistics.html#универсальный-кригинг",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\nВ методе универсального кригинга осуществляется декомпозиция переменной \\(Z(x)\\) в виде следующей суммы:\n\\[\nZ(x) = m(x) + Y(x)\n\\]\n\n\\(m(x)\\) — дрифт (drift), гладкая детерминированная функция, описывающая систематическую составляющую пространственной изменчивости явления;\n\\(Y(x)\\) - остаток (residual), случайная функция с нулевым математическим ожиданием, описывающая случайную составляющую пространственной изменчивости явления;\n\n\nДекомпозиция любого явления на дрифт и остаток зависит от масштаба рассмотрения явления."
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг-1",
    "href": "02_Geostatistics.html#универсальный-кригинг-1",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\nМетод универсального кригинга используется, когда математическое ожидание случайного процесса непостоянно по пространству. Это позволяет интерполировать данные, в которых присутствует тренд.\nВ предположении, что м.о. имеет функциональную зависимость от других процессов в точке \\(x\\), вводится следующая модель:\n\\[\nm(x) = \\sum_{k=0}^{K} a_k f^k(x),\n\\]\nгде \\(f^k(x)\\) — известные базисные функции, а \\(a_k\\) — фиксированные для точки \\(x\\), но неизвестные коэффициенты."
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг-2",
    "href": "02_Geostatistics.html#универсальный-кригинг-2",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\n\\[\nm(x) = \\sum_{k=0}^{K} a_k f^k(x),\n\\]\n\nОбычно первая базисная функция при \\(k = 0\\) представляет собой константу, равную 1. Это позволяет включить в модель случай постоянного м.о.\nЕсли среднее зависит только от местоположения, то оставшиеся функции \\(f^k(x), k &gt; 0\\), как правило, представляют собой одночлены от координат (например, для двумерного случая \\(f^2(p) = x^2 + y^2\\))\nКоэффициенты \\(a_k\\) могут меняться в зависимости от \\(x\\), но обязательно медленно, чтобы их можно было считать постоянными в окрестности \\(x\\)."
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг-3",
    "href": "02_Geostatistics.html#универсальный-кригинг-3",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\nВ качестве дрифта \\(m(x)\\) можно использовать не только функцию от местоположения, но также значения внешней переменной — ковариаты.\nНапример, количество осадков можно связать с высотой точки \\(H(x)\\) следующей моделью:\n\\[\nZ(x) = a_0 + a_1 H(x) + Y(x)\n\\]\nС статистической точки зрения это линейная регрессия, в которой остатки коррелированы (автокоррелированы).\n\nВ литературе данный метод называют также регрессионным кригингом (regression kriging), а оценка дрифта — пространственной регрессией (spatial regression)."
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг-4",
    "href": "02_Geostatistics.html#универсальный-кригинг-4",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\nДля вывода уравнений рассмотрим среднеквадратическую ошибку:\n\\[\n\\operatorname E[Z^* - Z_0]^2 = \\operatorname {Var}[Z^* - Z_0] + \\big(\\operatorname E[Z^* - Z_0]\\big)^2\n\\]\nИспользуя введенную модель дрифта \\(m(x) = \\sum_{k=0}^{K} a^k f^k(x)\\) распишем выражение для мат.ожидания приращений:\n\\[\n\\operatorname E[Z^* - Z_0] = \\operatorname E[Z^*\\big] - \\operatorname E[Z_0] = \\\\\n\\sum_i \\lambda_i \\sum_k a_k f_i^k - \\sum_k a_k f_0^k = \\sum_k a_k \\Bigg(\\sum_i \\lambda_i f_i^k - f_0^k\\Bigg)\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг-5",
    "href": "02_Geostatistics.html#универсальный-кригинг-5",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\n\\[\n\\operatorname E[Z^* - Z_0] = \\sum_k a_k \\Bigg(\\sum_i \\lambda_i f_i^k - f_0^k\\Bigg)\n\\]\nЧтобы минимизировать \\(\\operatorname E[Z^* - Z_0]\\) независимо от коэффициентов \\(a_k\\), достаточно в вышеприведенной формуле приравнять нулю выражение в скобках. Отсюда имеем:\n\\[\\sum_i \\lambda_i f_i^k = f_0^k,~k = 0, 1, ..., K.\\]\nЭти условия называются условиями универсальности. Отсюда идет название метода — универсальный кригинг\n\nУсловия универсальности гаранируют, что оценка \\(Z^*\\) является несмещенной для любых значений \\(a_k\\)."
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг-6",
    "href": "02_Geostatistics.html#универсальный-кригинг-6",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\nМинимизируем ранее введенную функцию ошибки:\n\\[\n\\operatorname {Var}[Z^* - Z_0] = \\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij} - 2 \\sum_{} \\lambda_i \\sigma_{i0} + \\sigma_{00}\n\\]\nДля этого, с учетом дополнительного условия \\(\\sum_i \\lambda_i f_i^k = f_0^k\\) применим метод множителей Лагранжа и построим вспомогательную функцию:\n\\[Q = \\operatorname {Var}[Z^* - Z_0] + 2 \\sum_{k=0}^K \\mu_k \\Bigg[ \\sum_i \\lambda_i f_i^k - f_0^k\\Bigg],\\]\nгде \\(\\mu_k,~k = 0, 1, ..., K\\) представляют \\(K + 1\\) дополнительных неизвестных, множители Лагранжа."
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг-7",
    "href": "02_Geostatistics.html#универсальный-кригинг-7",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\n\\[\n\\operatorname {Var}[Z^* - Z_0] = \\sum_{i}\\sum_{j} \\lambda_i \\lambda_j \\sigma_{ij} - 2 \\sum_{} \\lambda_i \\sigma_{i0} + \\sigma_{00}\n\\]\nДля минимизации функции приравняем нулю ее частные производные:\n\\[\n\\begin{cases}\\frac{\\partial Q}{\\partial \\lambda_i} = 2 \\sum_j \\lambda_j \\sigma_{ij} -2 \\sigma_{i0} + 2 \\sum_k \\mu_k f_i^k = 0,\\color{gray}{~i = 1,...,N,}\\\\\n\\frac{\\partial Q}{\\partial \\mu} = 2\\bigg[\\sum_i \\lambda_i f_i^k - f_0^k \\bigg] = 0\\color{gray}{,~k = 0, 1,..., K.}\n\\end{cases}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#универсальный-кригинг-8",
    "href": "02_Geostatistics.html#универсальный-кригинг-8",
    "title": "Геостатистика",
    "section": "Универсальный кригинг",
    "text": "Универсальный кригинг\nИмеем систему из \\(N + K + 1\\) уравнений с \\(N + K + 1\\) неизвестными:\n\\[\n\\begin{cases}\\sum_j \\lambda_j \\sigma_{ij} + \\sum_k \\mu_k f_i^k = \\sigma_{i0},~i = 1,...,N,\\\\\n\\sum_i \\lambda_i f_i^k = f_0^k,~k = 0, 1,..., K.\n\\end{cases}\n\\]\nЗаменяя ковариацию на вариограмму, получаем систему уравнений универсального кригинга:\n\\[\n\\color{red}{\\boxed{\\color{blue}{\\begin{cases}\\sum_j \\lambda_j \\gamma_{ij} - \\sum_k \\mu_k f_i^k = \\gamma_{i0},\\color{gray}{~i = 1,...,N,}\\\\\n\\sum_i \\lambda_i f_i^k = f_0^k\\color{gray}{,~k = 0, 1,..., K.}\n\\end{cases}}}}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#дисперсия-универсального-кригинга",
    "href": "02_Geostatistics.html#дисперсия-универсального-кригинга",
    "title": "Геостатистика",
    "section": "Дисперсия универсального кригинга",
    "text": "Дисперсия универсального кригинга\nВывод формулы для оценки дисперсии универсального кригинга выполняется аналогично случаю обычного кригинга. Умножим \\(N\\) первых уравнений на \\(\\lambda_i\\), просуммируем их по \\(i\\):\n\\[\n\\sum_j \\lambda_j \\gamma_{ij} - \\sum_k \\mu_k f_i^k = \\gamma_{i0} ~ \\Bigg|\\times \\lambda_i\n\\]\nУчтя дополнительное условие \\(\\sum_i \\lambda_i f_i^k = f_0^k\\), получаем выражение для оценки дисперсии (ошибки) универсального кригинга:\n\\[\n\\color{red}{\\boxed{\\color{blue}{\\sigma^2_{UK} = E[Z^* - Z_0]^2 = \\sum_{i}\\lambda_i\\gamma_{i0} - \\sum_k \\mu_k f_0^k}}}\n\\]"
  },
  {
    "objectID": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-6",
    "href": "02_Geostatistics.html#переход-от-ковариации-к-вариограмме-6",
    "title": "Геостатистика",
    "section": "Переход от ковариации к вариограмме",
    "text": "Переход от ковариации к вариограмме\nСтационарный случай:\n\\[\n\\operatorname {Cov} \\Bigg[\\sum_{\\alpha=1}^N \\lambda_{\\alpha} Z(x_{\\alpha}), \\sum_{\\beta=1}^M \\mu_{\\beta} Z(x_{\\beta}) \\Bigg] = \\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\operatorname C(x_{\\beta} - x_{\\alpha})\n\\]\nВнутренняя гипотеза:\n\\[\n\\operatorname {Cov} \\Bigg[\\sum_{\\alpha=1}^N \\lambda_{\\alpha} Z(x_{\\alpha}), \\sum_{\\beta=1}^M \\mu_{\\beta} Z(x_{\\beta}) \\Bigg] = - \\sum_{\\alpha=1}^N \\sum_{\\beta=1}^M \\lambda_{\\alpha} \\mu_{\\beta} \\gamma(x_{\\beta} - x_{\\alpha})\n\\]\n\nПри соблюдении внутренней гипотезы в уравнениях кригинга можно принять \\(\\sigma_{\\alpha \\beta} = -\\gamma_{\\alpha \\beta}\\)"
  },
  {
    "objectID": "02_Geostatistics.html#диаграмма-рассеяния-с-лагом",
    "href": "02_Geostatistics.html#диаграмма-рассеяния-с-лагом",
    "title": "Геостатистика",
    "section": "Диаграмма рассеяния с лагом",
    "text": "Диаграмма рассеяния с лагом\nLagged scatterplot — вариант диаграммы рассеяния, на котором показываются значения в точках, расстояние между которыми попадает в заданный интервал"
  },
  {
    "objectID": "02_Geostatistics.html#вариограммное-облако",
    "href": "02_Geostatistics.html#вариограммное-облако",
    "title": "Геостатистика",
    "section": "Вариограммное облако",
    "text": "Вариограммное облако\nКвадрат разности значений как функция от расстояния между точками"
  },
  {
    "objectID": "02_Geostatistics.html#эмпирическая-вариограмма",
    "href": "02_Geostatistics.html#эмпирическая-вариограмма",
    "title": "Геостатистика",
    "section": "Эмпирическая вариограмма",
    "text": "Эмпирическая вариограмма\nЭмпирическая вариограмма рассчитывается путем разбиения вар. облака на интервалы расстояний — лаги — и подсчета среднего значения \\(\\gamma\\) в каждом лаге:"
  },
  {
    "objectID": "02_Geostatistics.html#эмпирическая-вариограмма-1",
    "href": "02_Geostatistics.html#эмпирическая-вариограмма-1",
    "title": "Геостатистика",
    "section": "Эмпирическая вариограмма",
    "text": "Эмпирическая вариограмма\n\\[\\hat{\\gamma} = \\frac{1}{2N_h} \\sum_{x_i - x_j \\approx h} \\big[z(x_i) - z(x_j)\\big]^2\\]\n\nРазмер точки означает количество пар значений, которые попали в каждый лаг."
  },
  {
    "objectID": "02_Geostatistics.html#эмпирическая-вариограмма-2",
    "href": "02_Geostatistics.html#эмпирическая-вариограмма-2",
    "title": "Геостатистика",
    "section": "Эмпирическая вариограмма",
    "text": "Эмпирическая вариограмма\nПоскольку вариограмма есть дисперсия разности значений, ее рост можно оценить также по увеличению размера «ящика» на диаграмме размаха \\(\\sqrt\\gamma\\):"
  },
  {
    "objectID": "02_Geostatistics.html#вариокарта",
    "href": "02_Geostatistics.html#вариокарта",
    "title": "Геостатистика",
    "section": "Вариокарта",
    "text": "Вариокарта\nВариокарта (variogram map, variomap) представляет вариограмму как функцию приращений координат: \\[\\hat{\\gamma} (\\Delta x, \\Delta y) = \\frac{1}{2N_{\\substack{\\Delta x\\\\ \\Delta y}}} \\sum_{\\substack{\\Delta x_{ij} \\approx \\Delta x\\\\ \\Delta y_{ij} \\approx \\Delta y}} \\big[z(p_i) - z(p_j)\\big]^2\\]\n\n\n\n\n\n\n\n\n\n\n\n\nВариокарта используется для выявления пространственной анизотропии. Профиль по линии из центра к краю вариокарты даст эмпирическую вариограмму"
  },
  {
    "objectID": "02_Geostatistics.html#эмпирическая-и-теоретическая-вариограмма",
    "href": "02_Geostatistics.html#эмпирическая-и-теоретическая-вариограмма",
    "title": "Геостатистика",
    "section": "Эмпирическая и теоретическая вариограмма",
    "text": "Эмпирическая и теоретическая вариограмма\nВ уравнениях кригинга нельзя использовать эмпирическую вариограмму.\n\nЭто связано с тем, что уравнения ординарного (обычного) кригинга выводятся из предположения о том, что вариограмма является условно положительно определенной функцией.\nВыполнение этого условия нельзя гарантировать для эмпирической кривой.\nНеобходимо использовать теоретическую функцию — модель вариограммы — которая отвечает условной положительной определенности.\nМодель вариограммы выбирается исходя из формы эмпирической вариограммы."
  },
  {
    "objectID": "02_Geostatistics.html#свойства-вариограммы",
    "href": "02_Geostatistics.html#свойства-вариограммы",
    "title": "Геостатистика",
    "section": "Свойства вариограммы",
    "text": "Свойства вариограммы\n\\[\\gamma (\\mathbf{h}) = \\gamma(\\mathbf{x}, \\mathbf{x + h}) = \\operatorname E\\big[Z(x + h)-Z(x)\\big]^2\\]\nИсходя из определения \\(\\gamma\\), можно вывести ряд обязательных свойств модели:\n\nВариограмма симметрична:\n\\[\\gamma(\\mathbf{h}) = \\gamma(-\\mathbf{h})\\]\nВариограмма связана с дисперсией:\n\\[\\gamma(\\infty) = \\operatorname{Var}\\big[ Z(\\mathbf{x}) \\big]\\]\nВариограмма связана с ковариацией:\n\\[\\gamma(\\mathbf{h}) = \\operatorname{Var}\\big[Z(\\mathbf{x}) \\big] - \\operatorname C(\\mathbf{h})\\]"
  },
  {
    "objectID": "02_Geostatistics.html#приближение-теоретической-модели",
    "href": "02_Geostatistics.html#приближение-теоретической-модели",
    "title": "Геостатистика",
    "section": "Приближение теоретической модели",
    "text": "Приближение теоретической модели\nПриближение (fitting) модели вариограммы предполагает:\n\nВыбор теоретической модели\nПодбор параметров модели: эффект самородка (nugget), радиус корреляции ( \\(a\\) или range) и плато (sill)."
  },
  {
    "objectID": "02_Geostatistics.html#сферическая-модель",
    "href": "02_Geostatistics.html#сферическая-модель",
    "title": "Геостатистика",
    "section": "Сферическая модель",
    "text": "Сферическая модель\n\\[\\gamma(h) = \\begin{cases}\n  c_0 + c\\Big[\\frac{3h}{2a} - \\frac{1}{2}\\big(\\frac{h}{a}\\big)^3\\Big], & h \\leq a; \\\\\n  c_0 + c, & h &gt; a.\n\\end{cases}\\]\n\\[\\gamma(a) = \\operatorname{Var}[Z(p)] = c_0 + c\\]"
  },
  {
    "objectID": "02_Geostatistics.html#экспоненциальная-модель",
    "href": "02_Geostatistics.html#экспоненциальная-модель",
    "title": "Геостатистика",
    "section": "Экспоненциальная модель",
    "text": "Экспоненциальная модель\n\\[\\gamma(h) = \\begin{cases}\n  0, & h = 0; \\\\\n  c_0 + (c-c_0)\\Big[1 - \\exp\\big(\\frac{-3h}{a}\\big)\\Big], & h \\neq 0.\n\\end{cases}\\]\n\\[\\gamma(a) = \\operatorname{Var}[Z(p)] = c_0 + c\\]"
  },
  {
    "objectID": "02_Geostatistics.html#экспоненциальная-модель-1",
    "href": "02_Geostatistics.html#экспоненциальная-модель-1",
    "title": "Геостатистика",
    "section": "Экспоненциальная модель",
    "text": "Экспоненциальная модель\n\n\nДанная модель достигает плато асимптотически.\nВ точке \\(h = a\\) достигается \\(95\\%\\) уровня плато."
  },
  {
    "objectID": "02_Geostatistics.html#гауссова-модель",
    "href": "02_Geostatistics.html#гауссова-модель",
    "title": "Геостатистика",
    "section": "Гауссова модель",
    "text": "Гауссова модель\n\\[\\gamma(h) = c_0 + c\\Bigg[1 - \\exp\\bigg(\\frac{-3h^2}{a^2}\\bigg)\\Bigg]\\]"
  },
  {
    "objectID": "02_Geostatistics.html#гауссова-модель-1",
    "href": "02_Geostatistics.html#гауссова-модель-1",
    "title": "Геостатистика",
    "section": "Гауссова модель",
    "text": "Гауссова модель\n\n\nДанная модель достигает плато асимптотически.\nВ точке \\(h = a\\) достигается \\(95\\%\\) уровня плато.\nОтличительной чертой этой модели является ее гладкость: параболическое поведение вблизи нуля и асимптотическое приближение к плато."
  },
  {
    "objectID": "02_Geostatistics.html#степенная-модель",
    "href": "02_Geostatistics.html#степенная-модель",
    "title": "Геостатистика",
    "section": "Степенная модель",
    "text": "Степенная модель\n\\[\\gamma(h) = \\begin{cases}\n  0, & h = 0; \\\\\n  c h^\\alpha, & h \\neq 0.\n\\end{cases}\\]"
  },
  {
    "objectID": "02_Geostatistics.html#степенная-модель-1",
    "href": "02_Geostatistics.html#степенная-модель-1",
    "title": "Геостатистика",
    "section": "Степенная модель",
    "text": "Степенная модель\n\n\nАвтокорреляция присутствует на всех расстояниях: \\(a \\rightarrow \\infty\\)\nПредположение о стационарности второго порядка не выполняется\nКак правило, это означает наличие тренда в данных"
  },
  {
    "objectID": "02_Geostatistics.html#эффект-самородка-модель-наггет",
    "href": "02_Geostatistics.html#эффект-самородка-модель-наггет",
    "title": "Геостатистика",
    "section": "Эффект самородка (модель наггет)",
    "text": "Эффект самородка (модель наггет)\n\\[\\gamma(h) = \\begin{cases}\n  0, & h = 0; \\\\\n  c_0, & h \\neq 0.\n\\end{cases}, ~ c_0 = C(0)\\]"
  },
  {
    "objectID": "02_Geostatistics.html#эффект-самородка-модель-наггет-1",
    "href": "02_Geostatistics.html#эффект-самородка-модель-наггет-1",
    "title": "Геостатистика",
    "section": "Эффект самородка (модель наггет)",
    "text": "Эффект самородка (модель наггет)\n\n\nНаличие у данных вариограммы типа наггет означает отсутствие пространственной корреляции.\nВозможные причины:\n\nАбсолютно случайное распределение\nМелкомасштабная вариабельность (меньше, чем расстояние между измерениями)\nОшибки в измерениях\nОшибки в координатах точек"
  },
  {
    "objectID": "02_Geostatistics.html#автоматическое-приближение",
    "href": "02_Geostatistics.html#автоматическое-приближение",
    "title": "Геостатистика",
    "section": "Автоматическое приближение",
    "text": "Автоматическое приближение\nДана вариограмма семейства \\(\\gamma (h; \\mathbf{b})\\), где \\(\\mathbf{b} = (b_1, ..., b_k)\\) — вектор из \\(k\\) параметров модели. Параметры \\(\\mathbf{b}\\) подбираются таким образом, чтобы минимизировать следующий функционал:\n\\[Q(\\mathbf{b}) = \\sum_{l=1}^{L} w_l \\big[\\hat{\\gamma}(h_l) - \\gamma (h; \\mathbf{b})\\big]^2,\\]\nгде \\(\\big\\{\\hat{\\gamma} (h_l): l = 1,...,L\\big\\}\\) — значения эмпирической вариограммы для \\(L\\) лагов, вычисленные по \\(N(h_l)\\) векторам.\nВеса \\(w_l\\) обычно выбираются исходя из отношения \\(w_l = N(h_l) / |h_l|\\), чтобы придать большее значение коротким расстояниям и лагам с хорошей оценкой."
  },
  {
    "objectID": "02_Geostatistics.html#автоматическое-приближение-1",
    "href": "02_Geostatistics.html#автоматическое-приближение-1",
    "title": "Геостатистика",
    "section": "Автоматическое приближение",
    "text": "Автоматическое приближение\n\\[Q(\\mathbf{b}) = \\sum_{l=1}^{L} w_l \\big[\\hat{\\gamma}(h_l) - \\gamma (h; \\mathbf{b})\\big]^2\\] Минимизация функционала осуществляется итеративно:\n\nПроцесс начинается с некоторого предположения \\(\\mathbf{b}^{(0)}\\)\nНа шаге \\(s\\) функция \\(Q\\) аппроксимируется в виде квадратичной формы \\(Q(\\mathbf{b}^{(s)}) \\approx \\sum_{i=1}^k \\sum_{j=1}^k \\delta_{ij} b_i b_j\\) путем разложения в ряд Тейлора вокруг точки \\(\\mathbf{b}^{(s)}\\).\nНовая точка минимума \\(\\mathbf{b}^{(s+1)}\\) находится как минимум квадратичной формы (этот минимум один).\n\nШаги 2-3 повторяются до тех пор, пока значение \\(Q\\) не станет меньше заданного порога."
  },
  {
    "objectID": "02_Geostatistics.html#автоматическое-приближение-2",
    "href": "02_Geostatistics.html#автоматическое-приближение-2",
    "title": "Геостатистика",
    "section": "Автоматическое приближение",
    "text": "Автоматическое приближение\nСравним результат ручного и автоматического приближения вариограммы:"
  },
  {
    "objectID": "02_Geostatistics.html#обычный-кригинг-4",
    "href": "02_Geostatistics.html#обычный-кригинг-4",
    "title": "Геостатистика",
    "section": "Обычный кригинг",
    "text": "Обычный кригинг\nРассмотрим данные по температуре:"
  },
  {
    "objectID": "02_Geostatistics.html#обычный-кригинг-5",
    "href": "02_Geostatistics.html#обычный-кригинг-5",
    "title": "Геостатистика",
    "section": "Обычный кригинг",
    "text": "Обычный кригинг\nВизуализируем найденную вариограмму:"
  },
  {
    "objectID": "02_Geostatistics.html#обычный-кригинг-6",
    "href": "02_Geostatistics.html#обычный-кригинг-6",
    "title": "Геостатистика",
    "section": "Обычный кригинг",
    "text": "Обычный кригинг\nВизуализируем найденную вариокарту:"
  },
  {
    "objectID": "02_Geostatistics.html#обычный-кригинг-7",
    "href": "02_Geostatistics.html#обычный-кригинг-7",
    "title": "Геостатистика",
    "section": "Обычный кригинг",
    "text": "Обычный кригинг\nПроинтерполируем, используя приближенную модель вариограммы:\n\n\n[using ordinary kriging]\n\n\nstars object with 2 dimensions and 2 attributes\nattribute(s):\n                 Min.   1st Qu.   Median     Mean  3rd Qu.      Max.\nvar1.pred  -0.4091735  7.707571 18.83325 21.50978 32.07393  67.26636\nvar1.var   30.9929191 45.435980 52.71968 58.67491 65.48474 186.22488\ndimension(s):\n  from  to  offset delta                refsys x/y\nx    1 213  332239  2000 WGS 84 / UTM zone 32N [x]\ny    1  99 5121556 -2000 WGS 84 / UTM zone 32N [y]"
  },
  {
    "objectID": "02_Geostatistics.html#оценка-кригинга",
    "href": "02_Geostatistics.html#оценка-кригинга",
    "title": "Геостатистика",
    "section": "Оценка кригинга",
    "text": "Оценка кригинга"
  },
  {
    "objectID": "02_Geostatistics.html#дисперсия-кригинга",
    "href": "02_Geostatistics.html#дисперсия-кригинга",
    "title": "Геостатистика",
    "section": "Дисперсия кригинга",
    "text": "Дисперсия кригинга\n\nДисперсия кригинга высока там, где мало данных"
  },
  {
    "objectID": "02_Geostatistics.html#среднеквадратическое-отклонение-кригинга",
    "href": "02_Geostatistics.html#среднеквадратическое-отклонение-кригинга",
    "title": "Геостатистика",
    "section": "Среднеквадратическое отклонение кригинга",
    "text": "Среднеквадратическое отклонение кригинга\n\nДля удобства интерпретации можно взять корень из дисперсии"
  },
  {
    "objectID": "02_Geostatistics.html#кросс-валидация",
    "href": "02_Geostatistics.html#кросс-валидация",
    "title": "Геостатистика",
    "section": "Кросс-валидация",
    "text": "Кросс-валидация\nЗначение переменной \\(Z(x)\\) оценивается в каждой точке \\(x_i\\) по данным в соседних точках \\(Z(x_j), ~ j \\neq i\\) как если бы \\(Z(x_i)\\) было неизвестно.\nВ каждой точке вычисляется оценка кригинга \\(Z_{-i}^*\\) и соответствующая дисперсия кригинга \\(\\sigma_{Ki}^2\\). Поскольку значение \\(Z_i = Z(x_i)\\) известно, мы можем вычислить:\n\nОшибку кригинга \\(E_i = Z_{-i}^* - Z_i\\)\nСтандартизированную ошибку \\(e_i = E_i / \\sigma_{Ki}\\)\n\nЕсли \\(\\gamma(h)\\) — теоретическая вариограмма, то \\(E_i = Z_{-i}^* - Z_i\\) — случайная величина с м.о. = \\(0\\) и дисперсией \\(\\sigma_{Ki}^2\\), а \\(e_i\\) имеет м.о. = \\(0\\) и дисперсию, равную \\(1\\)."
  },
  {
    "objectID": "02_Geostatistics.html#кросс-валидация-1",
    "href": "02_Geostatistics.html#кросс-валидация-1",
    "title": "Геостатистика",
    "section": "Кросс-валидация",
    "text": "Кросс-валидация\n\nОшибка кригинга \\(E_i = Z_{-i}^* - Z_i\\)\nСтандартизированная ошибка \\(e_i = E_i / \\sigma_{Ki}\\)\n\nСтандартно анализируются следующие карты и графики:\n\nКарта стандартизированных ошибок \\(e_i\\). Стационарность ошибок, отсутствие эффекта пропорциональности.\nГистограмма стандартизированных ошибок \\(e_i\\). Нормальность распределения, отсутствие аномалий.\nДиаграмма рассеяния \\((Z_{-i}^*, Z_i)\\). Сглаживающий эффект, соответствие оценки и реального значения.\nДиаграмма рассеяния \\((Z_{-i}^*, e_i)\\). Независимость (ортогональность) оценки и ошибки."
  },
  {
    "objectID": "02_Geostatistics.html#кросс-валидация-2",
    "href": "02_Geostatistics.html#кросс-валидация-2",
    "title": "Геостатистика",
    "section": "Кросс-валидация",
    "text": "Кросс-валидация\nДля выполнения кросс-валидации воспользуемся функцией krige.cv:\n\n\n   var1.pred var1.var observed     residual      zscore fold       sterr\n1   5.743730 34.84033      6.0   0.25627005  0.04341669    1  0.04341669\n2  11.137129 60.24070     10.0  -1.13712865 -0.14650910    2 -0.14650910\n3   6.929502 47.22732      7.0   0.07049833  0.01025846    3  0.01025846\n4  23.252858 48.06354      1.0 -22.25285758 -3.20979954    4 -3.20979954\n5  15.655167 56.76258      1.0 -14.65516724 -1.94517957    5 -1.94517957\n6  11.794241 44.03055      1.0 -10.79424095 -1.62672846    6 -1.62672846\n7  11.325378 62.65261      0.1 -11.22537769 -1.41818009    7 -1.41818009\n8  28.421330 75.24988      0.2 -28.22133030 -3.25330355    8 -3.25330355\n9   2.340115 58.30350      1.0  -1.34011550 -0.17550719    9 -0.17550719\n10  3.489972 62.96551      0.2  -3.28997242 -0.41461106   10 -0.41461106"
  },
  {
    "objectID": "02_Geostatistics.html#кросс-валидация-3",
    "href": "02_Geostatistics.html#кросс-валидация-3",
    "title": "Геостатистика",
    "section": "Кросс-валидация",
    "text": "Кросс-валидация\nCтандартизированные ошибки в стационарном случае должны быть распределены нормально:"
  },
  {
    "objectID": "02_Geostatistics.html#кросс-валидация-4",
    "href": "02_Geostatistics.html#кросс-валидация-4",
    "title": "Геостатистика",
    "section": "Кросс-валидация",
    "text": "Кросс-валидация\nОшибки должны быть независимы от значений:"
  },
  {
    "objectID": "02_Geostatistics.html#кросс-валидация-5",
    "href": "02_Geostatistics.html#кросс-валидация-5",
    "title": "Геостатистика",
    "section": "Кросс-валидация",
    "text": "Кросс-валидация\nОблако рассеяния оценки относительно истинных значений должно быть компактным:"
  },
  {
    "objectID": "02_Geostatistics.html#кросс-валидация-6",
    "href": "02_Geostatistics.html#кросс-валидация-6",
    "title": "Геостатистика",
    "section": "Кросс-валидация",
    "text": "Кросс-валидация\nПространственная картина стандартизированных ошибок должна быть гомогенной:"
  },
  {
    "objectID": "03_SpatialRegression.html#базовые-компоненты",
    "href": "03_SpatialRegression.html#базовые-компоненты",
    "title": "Пространственная регрессия",
    "section": "Базовые компоненты",
    "text": "Базовые компоненты"
  },
  {
    "objectID": "03_SpatialRegression.html#особенности-случайных-процессов-в-пространстве",
    "href": "03_SpatialRegression.html#особенности-случайных-процессов-в-пространстве",
    "title": "Пространственная регрессия",
    "section": "Особенности случайных процессов в пространстве",
    "text": "Особенности случайных процессов в пространстве\n\nПространственная зависимость (spatial dependence) — наличие автокорреляции наблюдений.\n\nВыражается в зависимости остатков линейной регрессии. Устраняется посредством пространственной регрессии (spatial regression).\n\nПространственная гетерогенность (spatial heterogeneity) — нестационарность процессов, порождающих наблюдаемую переменную.\n\nВыражается в неэффективности постоянных коэффициентов линейной регрессии. Устраняется постредством географически взвешенной регрессии (geographically weighted regression)."
  },
  {
    "objectID": "03_SpatialRegression.html#линейная-регрессия",
    "href": "03_SpatialRegression.html#линейная-регрессия",
    "title": "Пространственная регрессия",
    "section": "Линейная регрессия",
    "text": "Линейная регрессия\nПусть дан вектор \\(\\mathbf{y} = \\{y_1, y_2, ... y_n\\}\\) измерений зависимой переменной, а также матрица \\(\\mathbf{X} = \\{x_{ij}\\}\\) размером \\(n \\times m\\), состоящая из значений \\(m\\) независимых переменных для \\(n\\) измерений. В этом случае модель линейной регрессии может быть записана как\n\\[\\mathbf{y} = \\mathbf{X} \\boldsymbol\\beta + \\boldsymbol\\epsilon,\\]\nгде:\n\n\\(\\boldsymbol\\beta\\) — вектор коэффициентов регрессии;\n\\(\\boldsymbol\\epsilon\\) — вектор случайных ошибок, независимо распределенных относительно среднего значения в нуле."
  },
  {
    "objectID": "03_SpatialRegression.html#пример",
    "href": "03_SpatialRegression.html#пример",
    "title": "Пространственная регрессия",
    "section": "Пример",
    "text": "Пример\nПроцент домохозяйств, находящихся во владении"
  },
  {
    "objectID": "03_SpatialRegression.html#пример-1",
    "href": "03_SpatialRegression.html#пример-1",
    "title": "Пространственная регрессия",
    "section": "Пример",
    "text": "Пример\nУровень безработицы"
  },
  {
    "objectID": "03_SpatialRegression.html#пример-2",
    "href": "03_SpatialRegression.html#пример-2",
    "title": "Пространственная регрессия",
    "section": "Пример",
    "text": "Пример\nОбычная линейная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#пример-3",
    "href": "03_SpatialRegression.html#пример-3",
    "title": "Пространственная регрессия",
    "section": "Пример",
    "text": "Пример\nОстатки регрессии"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия",
    "href": "03_SpatialRegression.html#пространственная-регрессия",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия\nДля того чтобы учесть пространственную автокорреляцию остатков, в модель линейной регрессии добавляется компонента пространственной авторегрессии (spatial autoregression), которая моделирует пространстенный лаг:\n\\[\\mathbf{y} = \\underbrace{\\mathbf{X} \\mathbf{\\beta}}_{тренд} + \\underbrace{\\color{red}{\\rho\\mathbf{Wy}}}_{сигнал} +  \\underbrace{\\mathbf{\\epsilon}}_{шум},\\]\n\n\\(\\rho\\) — коэффициент регрессии, отражающий степень пространственной автокорреляции\n\\(\\mathbf{W}\\) — матрица пространственных весов\n\n\nПолученная модель называется моделью пространственной регрессии (spatial regression).\n\nКомпоненты модели (тренд, сигнал и шум) называются предикторами."
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия-1",
    "href": "03_SpatialRegression.html#пространственная-регрессия-1",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия\nДля получения коэффициентов \\(\\boldsymbol\\beta\\) и \\(\\rho\\) выполним ряд преобразований:\n\\[\\mathbf{y} = \\mathbf{X} \\mathbf{\\beta} + \\rho\\mathbf{Wy} +  \\mathbf{\\epsilon}\\\\\n\\mathbf{y} - \\rho\\mathbf{Wy} = \\mathbf{X} \\mathbf{\\beta} + \\mathbf{\\epsilon}\\\\\n(\\mathbf{I} - \\rho\\mathbf{W})\\mathbf{y} = \\mathbf{X} \\mathbf{\\beta} + \\mathbf{\\epsilon}\\]\nПредполагая, что матрица \\((\\mathbf{I} - \\rho\\mathbf{W})\\) инвертируема, получаем систему уравнений пространственной регрессии:\n\\[\\color{red}{\\boxed{\\color{blue}{\\mathbf{y} = (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{X}\\mathbf{\\beta} + (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{\\epsilon}}}}\\]\nДанная модель идентична обычной регрессии \\(\\mathbf{y} = \\mathbf{X} \\mathbf{\\beta} + \\mathbf{\\epsilon}\\), но в ней независимые переменные и ошибки линейно трансформированы умножением на \\((\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\)."
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия-2",
    "href": "03_SpatialRegression.html#пространственная-регрессия-2",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия\n\\[\\mathbf{y} = \\mathbf{X} \\mathbf{\\beta} + \\rho\\mathbf{Wy} +  \\mathbf{\\epsilon}\\]\nДля нахождения коэффициентов \\(\\boldsymbol\\beta\\) и \\(\\rho\\) используется минимизация квадрата случайной компоненты, которую можно представить как \\(\\mathbf{\\epsilon} = \\mathbf{y} - \\mathbf{X} \\mathbf{\\beta} - \\rho\\mathbf{Wy}\\):\n\\[\\sum_i \\Bigg(y_i - \\sum_j \\beta_j x_{ij} - \\rho \\sum_j w_{ij} y_j \\Bigg)^2\\]\nЗадача решается в 2 этапа:\n\nнаходится оптимальное значение \\(\\rho\\);\nнаходится оптимальное значение \\(\\boldsymbol\\beta\\) путем подстановки в вышеуказанное выражение."
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-фильтрация",
    "href": "03_SpatialRegression.html#пространственная-фильтрация",
    "title": "Пространственная регрессия",
    "section": "Пространственная фильтрация",
    "text": "Пространственная фильтрация\nМодель пространственной регрессии может быть использована для осуществления пространственной фильтрации — убирания автокорреляционной составляющей.\nДля этого необходимо авторегрессионную компоненту (пространственный лаг) перенести в левую часть уравнения:\n\\[\\mathbf{y} = \\mathbf{X} \\mathbf{\\beta} + \\rho\\mathbf{Wy} + \\mathbf{\\epsilon}\\\\\n\\mathbf{y}^* = \\mathbf{y} - \\rho\\mathbf{Wy} = \\mathbf{X} \\mathbf{\\beta} + \\mathbf{\\epsilon}\\]\n\nПространственная фильтрация бывает полезна, когда наблюдается несоответствие масштаба наблюдений и масштаба процесса.\nНапример, статистика по показателю, контролируемому на региональном уровне, собирается по муниципалитетам. В этом случае фильтрация позволяет подобрать параметры \\(\\mathbf{\\beta}\\), учитывающие наличие высокой пространственной автокорреляци."
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-фильтрация-1",
    "href": "03_SpatialRegression.html#пространственная-фильтрация-1",
    "title": "Пространственная регшрессия",
    "section": "Пространственная фильтрация",
    "text": "Пространственная фильтрация\n\\[\\mathbf{y}^* = \\mathbf{y} - \\rho\\mathbf{Wy} = \\mathbf{X} \\mathbf{\\beta} + \\mathbf{\\epsilon}\\]\n\nПространственная фильтрация бывает полезна, когда наблюдается несоответствие масштаба наблюдений и масштаба процесса.\nНапример, статистика по показателю, контролируемому на региональном уровне, собирается по муниципалитетам. В этом случае фильтрация позволяет подобрать параметры \\(\\mathbf{\\beta}\\), учитывающие наличие высокой пространственной автокорреляци."
  },
  {
    "objectID": "03_SpatialRegression.html#оценка-географического-соседства",
    "href": "03_SpatialRegression.html#оценка-географического-соседства",
    "title": "Пространственная регрессия",
    "section": "Оценка географического соседства",
    "text": "Оценка географического соседства\nПримеры иллюстрируются по данным Кировской области:"
  },
  {
    "objectID": "03_SpatialRegression.html#оценка-географического-соседства-1",
    "href": "03_SpatialRegression.html#оценка-географического-соседства-1",
    "title": "Пространственная регрессия",
    "section": "Оценка географического соседства",
    "text": "Оценка географического соседства\nВ целом, можно выделить три большие группы методов:\n\nСоседи по смежности\nСоседи по графу\nСоседи по метрике"
  },
  {
    "objectID": "03_SpatialRegression.html#соседство-по-смежности",
    "href": "03_SpatialRegression.html#соседство-по-смежности",
    "title": "Пространственная регрессия",
    "section": "Соседство по смежности",
    "text": "Соседство по смежности\n\nСоседство по смежности основано на топологических отношениях между объектами и применяется при анализе данных, приуроченных к площадным единицам."
  },
  {
    "objectID": "03_SpatialRegression.html#соседство-по-смежности-1",
    "href": "03_SpatialRegression.html#соседство-по-смежности-1",
    "title": "Пространственная регрессия",
    "section": "Соседство по смежности",
    "text": "Соседство по смежности"
  },
  {
    "objectID": "03_SpatialRegression.html#соседство-по-графу",
    "href": "03_SpatialRegression.html#соседство-по-графу",
    "title": "Пространственная регрессия",
    "section": "Соседство по графу",
    "text": "Соседство по графу\nСоседство по графу основано на отношениях объектов в триангуляции Делоне.\n\n\nВ эту же категорию попадают всевозможные фильтрации триангуляции Делоне, которые удаляют из нее ребра, не удовлетворяющие заданным критериям:\n\nсфера влияния\nграф Гэбриела\nотносительное соседство"
  },
  {
    "objectID": "03_SpatialRegression.html#соседство-по-триангуляции-делоне",
    "href": "03_SpatialRegression.html#соседство-по-триангуляции-делоне",
    "title": "Пространственная регрессия",
    "section": "Соседство по триангуляции Делоне",
    "text": "Соседство по триангуляции Делоне\n\n\nСоседство по триангуляции реализуется путем триангулирования центров территориальных единиц.\n\nВнешние ребра идут по выпуклой оболочке множества центров\nОчень много связей между единицами, которые реально соседними не являются"
  },
  {
    "objectID": "03_SpatialRegression.html#сфера-влияния",
    "href": "03_SpatialRegression.html#сфера-влияния",
    "title": "Пространственная регрессия",
    "section": "Сфера влияния",
    "text": "Сфера влияния\n\nРебра триангуляции, инцидентные (примыкающие к) данной вершине, сохраняются только если \\(D \\leq 2D_{min}\\)"
  },
  {
    "objectID": "03_SpatialRegression.html#соседство-по-сфере-влияния",
    "href": "03_SpatialRegression.html#соседство-по-сфере-влияния",
    "title": "Пространственная регрессия",
    "section": "Соседство по сфере влияния",
    "text": "Соседство по сфере влияния"
  },
  {
    "objectID": "03_SpatialRegression.html#граф-гэбриела",
    "href": "03_SpatialRegression.html#граф-гэбриела",
    "title": "Пространственная регрессия",
    "section": "Граф Гэбриела",
    "text": "Граф Гэбриела\n\nВ каждом треугольнике ребро сохранятся только тогда, когда построенная на нем окружность не включает третью точку треугольника"
  },
  {
    "objectID": "03_SpatialRegression.html#соседство-по-графу-гэбриела",
    "href": "03_SpatialRegression.html#соседство-по-графу-гэбриела",
    "title": "Пространственная регрессия",
    "section": "Соседство по графу Гэбриела",
    "text": "Соседство по графу Гэбриела"
  },
  {
    "objectID": "03_SpatialRegression.html#граф-относительного-соседства",
    "href": "03_SpatialRegression.html#граф-относительного-соседства",
    "title": "Пространственная регрессия",
    "section": "Граф относительного соседства",
    "text": "Граф относительного соседства\n\n\nПолучается путем фильтрации триангуляции Делоне по следующему правилу:\n\nребро \\(A\\), соединяющее две вершины \\(p\\) и \\(q\\), будет удалено, если найдется третья вершина \\(r\\), такая что расстояния от нее до \\(p\\) и \\(q\\) ( \\(B\\) и \\(C\\) соответственно) окажутся короче, чем \\(A\\), то есть: \\(A &gt; B\\) and \\(A &gt; C\\)."
  },
  {
    "objectID": "03_SpatialRegression.html#относительное-соседство",
    "href": "03_SpatialRegression.html#относительное-соседство",
    "title": "Пространственная регшрессия",
    "section": "Относительное соседство",
    "text": "Относительное соседство"
  },
  {
    "objectID": "03_SpatialRegression.html#соседи-по-метрике",
    "href": "03_SpatialRegression.html#соседи-по-метрике",
    "title": "Пространственная регрессия",
    "section": "Соседи по метрике",
    "text": "Соседи по метрике\nПоиск соседей по метрике — наиболее простой способ определения соседства.\nДля его использования необходимо задать метрику (как правило, расстояние между точками), а также критерий фильтрации связей:\n\nпо количеству ( \\(k\\) ближайших)\nпо расстоянию (не ближе чем \\(d_1\\), но и не далее чем \\(d_2\\))."
  },
  {
    "objectID": "03_SpatialRegression.html#соседи-по-количеству",
    "href": "03_SpatialRegression.html#соседи-по-количеству",
    "title": "Пространственная регрессия",
    "section": "Соседи по количеству",
    "text": "Соседи по количеству"
  },
  {
    "objectID": "03_SpatialRegression.html#соседи-по-расстоянию",
    "href": "03_SpatialRegression.html#соседи-по-расстоянию",
    "title": "Пространственная регрессия",
    "section": "Соседи по расстоянию",
    "text": "Соседи по расстоянию"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственные-веса",
    "href": "03_SpatialRegression.html#пространственные-веса",
    "title": "Пространственная регрессия",
    "section": "Пространственные веса",
    "text": "Пространственные веса\n\nПространственные веса характеризуют силу связи между единицами.\nЕсли единицы не являются соседними (по выбранному правилу), то пространственный вес их связи будет равен нулю. Во всех остальных случаях веса будут ненулевыми.\nПоскольку теоретически каждая единица может быть связана с любой другой единицей, распространена форма представления весов в виде матрицы \\(W\\) размером \\(N \\times N\\), где \\(N\\) – число единиц.\nНа пересечении \\(i\\)-й строки и \\(j\\)-го столбца матрицы располагается вес связи между \\(i\\)-й и \\(j\\)-й единицей."
  },
  {
    "objectID": "03_SpatialRegression.html#бинарная-матрица",
    "href": "03_SpatialRegression.html#бинарная-матрица",
    "title": "Пространственная регрессия",
    "section": "Бинарная матрица",
    "text": "Бинарная матрица\nЕсли связь есть, то ее вес равен единице (1), если нет — нулю (0)"
  },
  {
    "objectID": "03_SpatialRegression.html#нормированная-матрица",
    "href": "03_SpatialRegression.html#нормированная-матрица",
    "title": "Пространственная регрессия",
    "section": "Нормированная матрица",
    "text": "Нормированная матрица\nВес \\(j\\)-й единицы по отношению к \\(i\\)-й равен \\(1/n_i\\), где \\(n_i\\) — количество соседей у \\(i\\)."
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-автокорреляция",
    "href": "03_SpatialRegression.html#пространственная-автокорреляция",
    "title": "Пространственная регрессия",
    "section": "Пространственная автокорреляция",
    "text": "Пространственная автокорреляция"
  },
  {
    "objectID": "03_SpatialRegression.html#индекс-морана-morans-i",
    "href": "03_SpatialRegression.html#индекс-морана-morans-i",
    "title": "Пространственная регрессия",
    "section": "Индекс Морана (Moran’s I)",
    "text": "Индекс Морана (Moran’s I)\nАнализ пространственной автокорреляции осуществляется, как правило, путем вычисления индекса Морана (Moran’s I):\n\\[I = \\frac{n \\sum^n_{i=1} \\sum^n_{j=i} w_{ij} (y_i - \\bar y)(y_j - \\bar y)}{ \\Big[\\sum^n_{i=1} \\sum^n_{j=i} w_{ij}\\Big] \\Big[\\sum^n_{i=1} (y_i - \\bar y)^2\\Big]}\\]\nгде:\n\n\\(n\\) — количество единиц,\n\\(w_{ij}\\) — вес пространственной связи между \\(i\\)-й и \\(j\\)-й единицей,\n\\(y_i\\) — значение в \\(i\\)-й единице,\n\\(\\bar y\\) — выборочное среднее по всем единицам"
  },
  {
    "objectID": "03_SpatialRegression.html#коэффициент-корреляции-пирсона",
    "href": "03_SpatialRegression.html#коэффициент-корреляции-пирсона",
    "title": "Пространственная регрессия",
    "section": "Коэффициент корреляции Пирсона",
    "text": "Коэффициент корреляции Пирсона\nОбратим внимание на то, что индекс Морана по сути и форме записи похож на линейный коэффициент корреляции Пирсона, в котором перебираются все пары соответствующих друг другу значений из рядов \\(X = \\{x_i\\}\\) и \\(Y = \\{y_i\\}\\):\n\\[r_{xy} = \\frac{\\sum_{i=1}^{n}(x_i - \\bar x)(y_i - \\bar y)}{\\sqrt{\\sum_{i=1}^{n}(x_i - \\bar x)^2} \\sqrt{\\sum_{i=1}^{n}(y_i - \\bar y)^2}}\\]"
  },
  {
    "objectID": "03_SpatialRegression.html#индекс-морана-morans-i-1",
    "href": "03_SpatialRegression.html#индекс-морана-morans-i-1",
    "title": "Пространственная регрессия",
    "section": "Индекс Морана (Moran’s I)",
    "text": "Индекс Морана (Moran’s I)\nИндекс Морана для нормально распределенных данных лежит в диапазоне от -1 до 1:\n\n+1 означает детерминированную прямую зависимость — группировку схожих (низких или высоких) значений.\n0 означает абсолютно случайное распределение (CSR — complete spatial randomness)\n-1 означает детерминированную обратную зависимость — идеальное перемешивание низких и высоких значений, напоминающее шахматную доску\n\nМатематическое ожидание индекса Морана для случайных данных равно \\(E[I] = -1/(n-1)\\)"
  },
  {
    "objectID": "03_SpatialRegression.html#индекс-морана-morans-i-2",
    "href": "03_SpatialRegression.html#индекс-морана-morans-i-2",
    "title": "Пространственная регрессия",
    "section": "Индекс Морана (Moran’s I)",
    "text": "Индекс Морана (Moran’s I)\nИндекс Морана для данных за февраль:\n\n# Выбираем данные за февраль\nfeb = mun |&gt; \n  filter(month == 'Февраль')\n\n# Вычисление индекса (тест) Морана\nmoran.test(feb$nsick, W)\n## \n##  Moran I test under randomisation\n## \n## data:  feb$nsick  \n## weights: W    \n## \n## Moran I statistic standard deviate = 5.0335, p-value = 0.0000002408\n## alternative hypothesis: greater\n## sample estimates:\n## Moran I statistic       Expectation          Variance \n##        0.52118132       -0.02564103        0.01180194"
  },
  {
    "objectID": "03_SpatialRegression.html#перестановочный-тест-морана",
    "href": "03_SpatialRegression.html#перестановочный-тест-морана",
    "title": "Пространственная регрессия",
    "section": "Перестановочный тест Морана",
    "text": "Перестановочный тест Морана\nЗначения перемешиваются между территориальными единицами и далее строится гистограмма распределения. Значимость индека Морана оценивается по отклонению реального значения от среднего по случайным симуляциям"
  },
  {
    "objectID": "03_SpatialRegression.html#перестановочный-тест-морана-1",
    "href": "03_SpatialRegression.html#перестановочный-тест-морана-1",
    "title": "Пространственная регрессия",
    "section": "Перестановочный тест Морана",
    "text": "Перестановочный тест Морана\nЗначения перемешиваются между территориальными единицами и далее строится гистограмма распределения. Значимость индека Морана оценивается по отклонению\n\n## \n##  Monte-Carlo simulation of Moran I\n## \n## data:  feb$nsick \n## weights: W  \n## number of simulations + 1: 10001 \n## \n## statistic = 0.52118, observed rank = 10001, p-value = 0.00009999\n## alternative hypothesis: greater"
  },
  {
    "objectID": "03_SpatialRegression.html#диаграмма-рассеяния-морана",
    "href": "03_SpatialRegression.html#диаграмма-рассеяния-морана",
    "title": "Пространственная регрессия",
    "section": "Диаграмма рассеяния Морана",
    "text": "Диаграмма рассеяния Морана\n\n\n\n\n\n\n\n\n\n\n\n\nПо оси \\(X\\) откладывается значение в каждой территориальной единице, в по оси \\(Y\\) — ее пространственный лаг (средневзвешенное значение по всем ее соседям).\n\nТангенс угла наклона прямой равен значению индекса Морана.\nВыделенные фонариком единицы вносят наибольший вклад в индекс"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-авторегрессия",
    "href": "03_SpatialRegression.html#пространственная-авторегрессия",
    "title": "Пространственная регрессия",
    "section": "Пространственная авторегрессия",
    "text": "Пространственная авторегрессия\nПоиск уравнения пространственной регрессии и его авторегрессионной составляющей может быть выполнен посредством функций spautolm() и lagsarlm() из пакета spatialreg:\n\n(model = lagsarlm(nsick ~ 1, data = feb, listw = W))\n## \n## Call:\n## lagsarlm(formula = nsick ~ 1, data = feb, listw = W)\n## Type: lag \n## \n## Coefficients:\n##         rho (Intercept) \n##    0.704957 1223.330336 \n## \n## Log likelihood: -346.2344"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-авторегрессия-1",
    "href": "03_SpatialRegression.html#пространственная-авторегрессия-1",
    "title": "Пространственная регрессия",
    "section": "Пространственная авторегрессия",
    "text": "Пространственная авторегрессия\nНа основе полученной модели можно построить карты пространственной авторегрессии и остатков:"
  },
  {
    "objectID": "03_SpatialRegression.html#предсказание-на-основе-пространственной-регрессии",
    "href": "03_SpatialRegression.html#предсказание-на-основе-пространственной-регрессии",
    "title": "Пространственная регшрессия",
    "section": "Предсказание на основе пространственной регрессии",
    "text": "Предсказание на основе пространственной регрессии\nДля вневыборочного предсказания используется ранее полученная модель прогнозирования \\(\\mathbf{y} = (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{X}\\mathbf{\\beta}\\). Однако ее необходимо также представить в стратифицированном виде:\n\\[\\begin{bmatrix}\\mathbf{Y_S}\\\\ \\mathbf{Y_O}\\end{bmatrix} = (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{X}\\mathbf{\\beta}=\\\\=\\begin{bmatrix}\\mathbf{I_{SS}} - \\rho\\mathbf{W_{SS}} & -\\rho\\mathbf{W_{SO}} \\\\ -\\rho\\mathbf{W_{OS}} & \\mathbf{I_{OO}} - \\rho\\mathbf{W_{OO}}\\end{bmatrix}^{-1} \\begin{bmatrix}\\mathbf{X_S}\\\\\\mathbf{X_O}\\end{bmatrix}\\beta=\\\\=\\begin{bmatrix}\\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{C} & \\mathbf{D}\\end{bmatrix}^{-1} \\begin{bmatrix}\\mathbf{X_S}\\\\\\mathbf{X_O}\\end{bmatrix}\\beta\\]"
  },
  {
    "objectID": "03_SpatialRegression.html#вневыборочное-предсказание",
    "href": "03_SpatialRegression.html#вневыборочное-предсказание",
    "title": "Пространственная регрессия",
    "section": "Вневыборочное предсказание",
    "text": "Вневыборочное предсказание\n\n\n\n\nGoulard, M., Laurent, T., Thomas-Agnan, C., 2017. About predictions in spatial autoregressive models: optimal and almost optimal strategies. Spatial Economic Analysis 12, 304–325. https://doi.org/10.1080/17421772.2017.1300679"
  },
  {
    "objectID": "03_SpatialRegression.html#внутривыборочное-предсказание",
    "href": "03_SpatialRegression.html#внутривыборочное-предсказание",
    "title": "Пространственная регрессия",
    "section": "Внутривыборочное предсказание",
    "text": "Внутривыборочное предсказание\nВнутривыброчное (in-sample) предсказание не требует дополнительных действий, поскольку оно осуществляется непосредственно моделью пространственной регрессии:\n\\[\\underbrace{\\mathbf{y}}_{отклик} = \\underbrace{\\mathbf{X} \\mathbf{\\beta}}_{тренд} + \\underbrace{\\rho\\mathbf{Wy}}_{сигнал} + \\underbrace{\\mathbf{\\epsilon}}_{шум}\\]"
  },
  {
    "objectID": "03_SpatialRegression.html#прогнозное-предсказание",
    "href": "03_SpatialRegression.html#прогнозное-предсказание",
    "title": "Пространственная регрессия",
    "section": "Прогнозное предсказание",
    "text": "Прогнозное предсказание\nПрогонозное (forecast) предсказание требует последовательного вычисления тренда, переменной отклика и сигнала. Для этого необходимо выполнить следующие преобразования:\n\\[\\mathbf{y} = \\mathbf{X} \\mathbf{\\beta} + \\rho\\mathbf{Wy} + \\mathbf{\\epsilon}\\\\\n(\\mathbf{I} - \\rho\\mathbf{W})\\mathbf{y} = \\mathbf{X}\\mathbf{\\beta} + \\mathbf{\\epsilon}\\\\\n\\mathbf{y} = (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{X}\\mathbf{\\beta} + (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{\\epsilon}\\]\nПрогноз с использованием полученного выражения делается в предположении, что \\(\\mathbf{\\epsilon} = 0\\). В этом случае, имея новые данные тренда \\(\\mathbf{X}\\mathbf{\\beta}\\), вычисляем сначала \\(\\mathbf{y} = (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{X}\\mathbf{\\beta}\\) и далее находим сигнал их умножением:\n\\[\\rho\\mathbf{Wy} = \\rho\\mathbf{W} (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{X}\\mathbf{\\beta}\\]"
  },
  {
    "objectID": "03_SpatialRegression.html#вневыборочное-предсказание-1",
    "href": "03_SpatialRegression.html#вневыборочное-предсказание-1",
    "title": "Пространственная регрессия",
    "section": "Вневыборочное предсказание",
    "text": "Вневыборочное предсказание\nВневыборочное (out-of-sample) предсказание связано с решением ситуации, когда есть данные по независимым переменным \\(\\mathbf{X_S}\\) и отклику \\(\\mathbf{Y_S}\\) по одним единицам и данные только по независимым переменным \\(\\mathbf{X_O}\\) для другой части единиц. Требуется найти отклик \\(\\mathbf{Y_O}\\) для этих единиц.\nДля решения этой задачи необходимо стратифицировать вектора данных и матрицу весов:\n\\[\\begin{bmatrix}\\mathbf{Y_S}\\\\ \\color{red}{\\mathbf{Y_O}}\\end{bmatrix} = \\rho \\begin{bmatrix}\\mathbf{W_{SS}} & \\mathbf{W_{SO}} \\\\ \\mathbf{W_{OS}} & \\mathbf{W_{OO}}\\end{bmatrix} \\begin{bmatrix}\\mathbf{Y_S}\\\\\\color{red}{\\mathbf{Y_O}}\\end{bmatrix} + \\begin{bmatrix}\\mathbf{X_S}\\\\\\mathbf{X_O}\\end{bmatrix} \\mathbf{\\beta} + \\begin{bmatrix}\\mathbf{\\epsilon_S}\\\\\\mathbf{\\epsilon_O}\\end{bmatrix}\\] Красным цветом выделены неизвестные данные."
  },
  {
    "objectID": "03_SpatialRegression.html#предсказание-на-основе-пространственной-регрессии-1",
    "href": "03_SpatialRegression.html#предсказание-на-основе-пространственной-регрессии-1",
    "title": "Пространственная регшрессия",
    "section": "Предсказание на основе пространственной регрессии",
    "text": "Предсказание на основе пространственной регрессии\n\\[\\begin{bmatrix}\\mathbf{Y_S}\\\\ \\mathbf{Y_O}\\end{bmatrix} = \\begin{bmatrix}\\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{C} & \\mathbf{D}\\end{bmatrix}^{-1} \\begin{bmatrix}\\mathbf{X_S}\\\\\\mathbf{X_O}\\end{bmatrix}\\beta\\]Раскрыв данное выражение, можно получить предсказания для выборочных и вневыборочных единиц:\n\\[\\mathbf{Y_S} = (\\mathbf{A} - \\mathbf{BD}^{-1} \\mathbf{C})^{-1} \\mathbf{X_S} \\mathbf{\\beta} -(\\mathbf{A} - \\mathbf{BD}^{-1} \\mathbf{C})^{-1} \\mathbf{BD}^{-1} \\mathbf{X_O} \\mathbf{\\beta}\\]\n\\[\\mathbf{Y_O} = (\\mathbf{D} - \\mathbf{CA}^{-1} \\mathbf{B})^{-1} \\mathbf{X_O} \\mathbf{\\beta} - (\\mathbf{D} - \\mathbf{CA}^{-1} \\mathbf{B})^{-1} \\mathbf{C} \\mathbf{A}^{-1} \\mathbf{X_S} \\mathbf{\\beta}\\]\n\n\n\nСамсонов Т. Е. Пространственная статистика: курс лекций"
  },
  {
    "objectID": "03_SpatialRegression.html#предсказание-на-основе-пространственной-регрессии-2",
    "href": "03_SpatialRegression.html#предсказание-на-основе-пространственной-регрессии-2",
    "title": "Пространственная регшрессия",
    "section": "Предсказание на основе пространственной регрессии",
    "text": "Предсказание на основе пространственной регрессии\n\\[\\begin{bmatrix}\\mathbf{Y_S}\\\\ \\mathbf{Y_O}\\end{bmatrix} = \\begin{bmatrix}\\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{C} & \\mathbf{D}\\end{bmatrix}^{-1} \\begin{bmatrix}\\mathbf{X_S}\\\\\\mathbf{X_O}\\end{bmatrix}\\beta\\] Раскрыв данное выражение, можно получить предсказания для выборочных и вневыборочных единиц:\n\\[\\mathbf{Y_S} = (\\mathbf{A} - \\mathbf{BD}^{-1} \\mathbf{C})^{-1} \\mathbf{X_S} \\mathbf{\\beta} -(\\mathbf{A} - \\mathbf{BD}^{-1} \\mathbf{C})^{-1} \\mathbf{BD}^{-1} \\mathbf{X_O} \\mathbf{\\beta}\\]\n\\[\\mathbf{Y_O} = (\\mathbf{D} - \\mathbf{CA}^{-1} \\mathbf{B})^{-1} \\mathbf{X_O} \\mathbf{\\beta} - (\\mathbf{D} - \\mathbf{CA}^{-1} \\mathbf{B})^{-1} \\mathbf{C} \\mathbf{A}^{-1} \\mathbf{X_S} \\mathbf{\\beta}\\]\n\n\n\nСамсонов Т. Е. Пространственная статистика: курс лекций"
  },
  {
    "objectID": "03_SpatialRegression.html#предсказание-на-основе-простр.-регрессии",
    "href": "03_SpatialRegression.html#предсказание-на-основе-простр.-регрессии",
    "title": "Пространственная регрессия",
    "section": "Предсказание на основе простр. регрессии",
    "text": "Предсказание на основе простр. регрессии\nРазличают три вида предсказания:\n\nВнутривыборочное (in-sample) используется для вычисления предикторов на основе данных, использованных для построения модели пространственной регрессии.\nПрогнозное (prevision/forecast) используется для вычисления предикторов на основе новых данных по тем же выборочным единицам\nВневыборочное (out-of-sample) используется для вычисления предикторов с включением новых выборочных единиц"
  },
  {
    "objectID": "03_SpatialRegression.html#вневыборочное-предсказание-2",
    "href": "03_SpatialRegression.html#вневыборочное-предсказание-2",
    "title": "Пространственная регрессия",
    "section": "Вневыборочное предсказание",
    "text": "Вневыборочное предсказание\nДля вневыборочного предсказания используется ранее полученная модель прогнозирования \\(\\mathbf{y} = (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{X}\\mathbf{\\beta}\\). Однако ее необходимо также представить в стратифицированном виде:\n\\[\\begin{bmatrix}\\mathbf{Y_S}\\\\ \\mathbf{Y_O}\\end{bmatrix} = (\\mathbf{I} - \\rho\\mathbf{W})^{-1}\\mathbf{X}\\mathbf{\\beta}=\\\\=\\begin{bmatrix}\\mathbf{I_{SS}} - \\rho\\mathbf{W_{SS}} & -\\rho\\mathbf{W_{SO}} \\\\ -\\rho\\mathbf{W_{OS}} & \\mathbf{I_{OO}} - \\rho\\mathbf{W_{OO}}\\end{bmatrix}^{-1} \\begin{bmatrix}\\mathbf{X_S}\\\\\\mathbf{X_O}\\end{bmatrix}\\beta=\\\\=\\begin{bmatrix}\\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{C} & \\mathbf{D}\\end{bmatrix}^{-1} \\begin{bmatrix}\\mathbf{X_S}\\\\\\mathbf{X_O}\\end{bmatrix}\\beta\\]"
  },
  {
    "objectID": "03_SpatialRegression.html#вневыборочное-предсказание-3",
    "href": "03_SpatialRegression.html#вневыборочное-предсказание-3",
    "title": "Пространственная регрессия",
    "section": "Вневыборочное предсказание",
    "text": "Вневыборочное предсказание\n\\[\\begin{bmatrix}\\mathbf{Y_S}\\\\ \\mathbf{Y_O}\\end{bmatrix} = \\begin{bmatrix}\\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{C} & \\mathbf{D}\\end{bmatrix}^{-1} \\begin{bmatrix}\\mathbf{X_S}\\\\\\mathbf{X_O}\\end{bmatrix}\\beta\\]Раскрыв данное выражение, можно получить предсказания для выборочных и вневыборочных единиц:\n\\[\\mathbf{Y_S} = (\\mathbf{A} - \\mathbf{BD}^{-1} \\mathbf{C})^{-1} \\mathbf{X_S} \\mathbf{\\beta} -(\\mathbf{A} - \\mathbf{BD}^{-1} \\mathbf{C})^{-1} \\mathbf{BD}^{-1} \\mathbf{X_O} \\mathbf{\\beta}\\]\n\\[\\mathbf{Y_O} = (\\mathbf{D} - \\mathbf{CA}^{-1} \\mathbf{B})^{-1} \\mathbf{X_O} \\mathbf{\\beta} - (\\mathbf{D} - \\mathbf{CA}^{-1} \\mathbf{B})^{-1} \\mathbf{C} \\mathbf{A}^{-1} \\mathbf{X_S} \\mathbf{\\beta}\\]"
  },
  {
    "objectID": "03_SpatialRegression.html#исходные-данные-пример",
    "href": "03_SpatialRegression.html#исходные-данные-пример",
    "title": "Пространственная регрессия",
    "section": "Исходные данные (пример)",
    "text": "Исходные данные (пример)"
  },
  {
    "objectID": "03_SpatialRegression.html#исходные-данные-пример-1",
    "href": "03_SpatialRegression.html#исходные-данные-пример-1",
    "title": "Пространственная регрессия",
    "section": "Исходные данные (пример)",
    "text": "Исходные данные (пример)"
  },
  {
    "objectID": "03_SpatialRegression.html#исходные-данные-пример-2",
    "href": "03_SpatialRegression.html#исходные-данные-пример-2",
    "title": "Пространственная регрессия",
    "section": "Исходные данные (пример)",
    "text": "Исходные данные (пример)"
  },
  {
    "objectID": "03_SpatialRegression.html#диаграмма-рассеяния",
    "href": "03_SpatialRegression.html#диаграмма-рассеяния",
    "title": "Пространственная регрессия",
    "section": "Диаграмма рассеяния",
    "text": "Диаграмма рассеяния\nДиаграмма рассеяния показывает соотношение переменных"
  },
  {
    "objectID": "03_SpatialRegression.html#линейная-регрессия-1",
    "href": "03_SpatialRegression.html#линейная-регрессия-1",
    "title": "Пространственная регрессия",
    "section": "Линейная регрессия",
    "text": "Линейная регрессия\nЛинейная регрессия дает аппроксимацию зависимости\n\nКоэффициент корреляции равен \\(-0.696\\)."
  },
  {
    "objectID": "03_SpatialRegression.html#линейная-регрессия-2",
    "href": "03_SpatialRegression.html#линейная-регрессия-2",
    "title": "Пространственная регрессия",
    "section": "Линейная регрессия",
    "text": "Линейная регрессия\nЛинейная регрессия дает аппроксимацию зависимости\n\nКоэффициент корреляции равен \\(-0.574\\)."
  },
  {
    "objectID": "03_SpatialRegression.html#линейная-регрессия-3",
    "href": "03_SpatialRegression.html#линейная-регрессия-3",
    "title": "Пространственная регрессия",
    "section": "Линейная регрессия",
    "text": "Линейная регрессия\nДля модели\n\\[\n\\texttt{CRIME} = \\beta_0 + \\beta_1 \\texttt{INC} + \\beta_2 \\texttt{HOVAL}\n\\]\nполучается следующая диагностика:\n\n##               Estimate Std. Error                   Pr(&gt;|t|)\n## (Intercept) 68.6189611  4.7354861 0.000000000000000000921089\n## INC         -1.5973108  0.3341308 0.000018289595070842137403\n## HOVAL       -0.2739315  0.1031987 0.010874504909753494874547\n\nТ.е. модель принимает следующий вид:\n\\[\n\\texttt{CRIME} = 68.619 -1.597~\\texttt{INC} - 0.274~\\texttt{HOVAL}\n\\]"
  },
  {
    "objectID": "03_SpatialRegression.html#линейная-регрессия-4",
    "href": "03_SpatialRegression.html#линейная-регрессия-4",
    "title": "Пространственная регрессия",
    "section": "Линейная регрессия",
    "text": "Линейная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#линейная-регрессия-5",
    "href": "03_SpatialRegression.html#линейная-регрессия-5",
    "title": "Пространственная регрессия",
    "section": "Линейная регрессия",
    "text": "Линейная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#линейная-регрессия-6",
    "href": "03_SpatialRegression.html#линейная-регрессия-6",
    "title": "Пространственная регрессия",
    "section": "Линейная регрессия",
    "text": "Линейная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#остатки-регрессии",
    "href": "03_SpatialRegression.html#остатки-регрессии",
    "title": "Пространственная регрессия",
    "section": "Остатки регрессии",
    "text": "Остатки регрессии\n\n\n\n\n\n\n\n\nВажно\n\n\nЕсли остатки от регрессии образуют пространственный рисунок, это значит, что независимых переменных недостаточно для предсказания исследуемой величины. Необходимо учитывать пространственную зависимость.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nПри анализе карт остатков регрессии обращают внимание на то, меняются ли они плавно по пространству, есть ли выраженный пространственный тренд и зависимость значений соседних единиц."
  },
  {
    "objectID": "03_SpatialRegression.html#пространственные-веса-1",
    "href": "03_SpatialRegression.html#пространственные-веса-1",
    "title": "Пространственная регрессия",
    "section": "Пространственные веса",
    "text": "Пространственные веса"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственные-веса-2",
    "href": "03_SpatialRegression.html#пространственные-веса-2",
    "title": "Пространственная регрессия",
    "section": "Пространственные веса",
    "text": "Пространственные веса"
  },
  {
    "objectID": "03_SpatialRegression.html#индекс-морана",
    "href": "03_SpatialRegression.html#индекс-морана",
    "title": "Пространственная регрессия",
    "section": "Индекс Морана",
    "text": "Индекс Морана\n\n\n\n\n\n\n\n\n\n\n\nИндекс Морана равен \\(0.500\\)\n\n\n\n\n\n\n\n\n\n\nИндекс Морана равен \\(0.222\\)\n\n\nПоскольку остатки регрессии по-прежнему автокоррелированы, можно сделать вывод о том, что независимые переменные не объясняют полностью величину преступности."
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия-3",
    "href": "03_SpatialRegression.html#пространственная-регрессия-3",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия\nДля нашего случая модель будет иметь вид:\n\\[\n\\texttt{CRIME} = 45.603 -1.049~\\texttt{INC} - 0.266~\\texttt{HOVAL} + 0.423~W~\\texttt{CRIME}\n\\]\n\n## \n## Call:\n## lagsarlm(formula = CRIME ~ INC + HOVAL, data = reg, listw = Wstand)\n## Type: lag \n## \n## Coefficients:\n##         rho (Intercept)         INC       HOVAL \n##   0.4233254  45.6032484  -1.0487282  -0.2663348 \n## \n## Log likelihood: -182.674"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия-4",
    "href": "03_SpatialRegression.html#пространственная-регрессия-4",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия-5",
    "href": "03_SpatialRegression.html#пространственная-регрессия-5",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия-6",
    "href": "03_SpatialRegression.html#пространственная-регрессия-6",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия-7",
    "href": "03_SpatialRegression.html#пространственная-регрессия-7",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#пространственная-регрессия-8",
    "href": "03_SpatialRegression.html#пространственная-регрессия-8",
    "title": "Пространственная регрессия",
    "section": "Пространственная регрессия",
    "text": "Пространственная регрессия"
  },
  {
    "objectID": "03_SpatialRegression.html#остатки-пространств.-регрессии",
    "href": "03_SpatialRegression.html#остатки-пространств.-регрессии",
    "title": "Пространственная регрессия",
    "section": "Остатки пространств. регрессии",
    "text": "Остатки пространств. регрессии\nИндекс Морана для остатков пространств. регрессии равен \\(0.033\\).\n\n\nАвтокорреляционная составляющая практически полностью учтена в модели пространственной регрессии. Предсказательная сила модели улучшена.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nСамсонов Т. Е. Пространственная статистика: курс лекций"
  },
  {
    "objectID": "04_GWRegression.html#особенности-случайных-процессов-в-пространстве",
    "href": "04_GWRegression.html#особенности-случайных-процессов-в-пространстве",
    "title": "Географически взвешенная регрессия",
    "section": "Особенности случайных процессов в пространстве",
    "text": "Особенности случайных процессов в пространстве\n\nПространственная зависимость (spatial dependence) — наличие автокорреляции наблюдений. Выражается в невыполнении условия независимости остатков линейной регрессии. Устраняется посредством пространственной регрессии (spatial regression).\nПространственная гетерогенность (spatial heterogeneity) — нестационарность процессов, порождающих наблюдаемую переменную. Выражается в неэффективности постоянных коэффициентов линейной регрессии. Устраняется постредством географически взвешенной регрессии (geographically weighted regression)."
  },
  {
    "objectID": "04_GWRegression.html#географически-взвешенная-регрессия",
    "href": "04_GWRegression.html#географически-взвешенная-регрессия",
    "title": "Географически взвешенная регрессия",
    "section": "Географически взвешенная регрессия",
    "text": "Географически взвешенная регрессия\nВ стандартной модели линейной регрессии параметры модели предполагаются постоянными:\n\\[\\mathbf{y} = \\mathbf{X} \\boldsymbol\\beta + \\boldsymbol\\epsilon,\\]\nДля \\(i\\)-й локации решение выглядит следующим образом:\n\\[y_i = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + ... + \\beta_m x_{mi} + \\epsilon_i\\]\nКоэффициенты находятся методом наименьших квадратов:\n\\[\\mathbf{\\beta}' = (\\mathbf{X}^T\\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{Y}\\]\nТакой подход, однако не учитывает того, что характер зависимости между переменными может меняться по пространству."
  },
  {
    "objectID": "04_GWRegression.html#географически-взвешенная-регрессия-1",
    "href": "04_GWRegression.html#географически-взвешенная-регрессия-1",
    "title": "Географически взвешенная регрессия",
    "section": "Географически взвешенная регрессия",
    "text": "Географически взвешенная регрессия\nВ географически взвешенной регрессионной модели веса определяются для каждой локации:\n\\[y_i = \\beta_{0i} + \\beta_{1i} x_{1i} + \\beta_{2i} x_{2i} + ... + \\beta_{mi} x_{mi} + \\epsilon_i\\]\nВ этом случае область оценки параметров \\(\\mathbf{\\beta}\\) ограничивается некой окрестностью точки \\(i\\). Математически это достигается применением весовых коэффициентов для данных независимых переменных:\n\\[\\mathbf{\\beta}'(i) = (\\mathbf{X}^T \\color{blue}{\\mathbf{W}(i)}\\mathbf{X})^{-1} \\mathbf{X}^T \\color{blue}{\\mathbf{W}(i)} \\mathbf{Y},\\]\nгде \\(\\mathbf{W}(i)\\) есть матрица весов для точки \\(i\\). Коэффициенты матрицы подбираются таким образом, что близкие локации получают более высокий вес."
  },
  {
    "objectID": "04_GWRegression.html#географически-взвешенная-регрессия-2",
    "href": "04_GWRegression.html#географически-взвешенная-регрессия-2",
    "title": "Географически взвешенная регрессия",
    "section": "Географически взвешенная регрессия",
    "text": "Географически взвешенная регрессия\nМатрица \\(\\mathbf{W}(i)\\) имеет размер \\(n \\times n\\), где \\(n\\) — число точек наблюдений:\n\\[\\mathbf{W}(i) = \\begin{bmatrix}\n    w_{i1} & 0 & 0 & \\dots  & 0 \\\\\n    0 & w_{i2} & 0 & \\dots  & 0 \\\\\n    0 & 0 & w_{i3} & \\dots  & 0 \\\\\n    \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n    0 & 0 & 0 & \\dots  & w_{in}\n\\end{bmatrix},\\]\nгде \\(w_{ik}\\) есть вес, который имеет точка \\(k\\) при локальной оценке параметров в точке \\(i\\)."
  },
  {
    "objectID": "04_GWRegression.html#весовая-функция",
    "href": "04_GWRegression.html#весовая-функция",
    "title": "Географически взвешенная регрессия",
    "section": "Весовая функция",
    "text": "Весовая функция\nДалёкие точки должны иметь меньший вес при вычислении коэффициентов. Например, для гауссовой весовой функции:\n\\[\nw_{ij} = \\operatorname{exp}\\Big\\{-\\frac{1}{2} (d_{ij}/h)^2\\Big\\},\n\\]\n\n\n\n\\(w_{ij}\\) — вес, который будет иметь \\(j\\)-я точка при вычислении коэффициентов регрессии в \\(i\\)-й точке;\n\\(d_{ij}\\) расстояние между ними;\n\\(h\\) — полоса пропускания"
  },
  {
    "objectID": "04_GWRegression.html#весовые-функции",
    "href": "04_GWRegression.html#весовые-функции",
    "title": "Географически взвешенная регрессия",
    "section": "Весовые функции",
    "text": "Весовые функции\nВ случае фиксированной весовой функции окрестность всегда имеет фиксированную полосу пропускания:"
  },
  {
    "objectID": "04_GWRegression.html#весовые-функции-1",
    "href": "04_GWRegression.html#весовые-функции-1",
    "title": "Географически взвешенная регрессия",
    "section": "Весовые функции",
    "text": "Весовые функции\nВ случае адаптивной весовой функции полоса пропускания определяется \\(N\\) ближайшими точками. Например для \\(N = 5\\):"
  },
  {
    "objectID": "04_GWRegression.html#полоса-пропускания",
    "href": "04_GWRegression.html#полоса-пропускания",
    "title": "Географически взвешенная регрессия",
    "section": "Полоса пропускания",
    "text": "Полоса пропускания\n\\[w_{ij} = \\operatorname{exp}\\Big\\{-\\frac{1}{2} (d_{ij}/h)^2\\Big\\},\\]\nПолоса пропускания \\(h\\) обладает следующими особенностями:\n\nмалая полоса пропускания приводит к большой дисперсии локальных оценок;\nбольшая полоса пропускания приводит к смещенности оценки;\nпри \\(h \\rightarrow \\infty\\) локальная модель приближается к глобальной регрессии;\nпри \\(h \\rightarrow 0\\) локальная модель «сворачивается» вокруг данных."
  },
  {
    "objectID": "04_GWRegression.html#практический-анализ",
    "href": "04_GWRegression.html#практический-анализ",
    "title": "Географически взвешенная регрессия",
    "section": "Практический анализ",
    "text": "Практический анализ\nВ качестве примера проанализируем каким образом цена жилья зависит от количества комнат на примере данных по стоимости недвижимости в Бостоне:"
  },
  {
    "objectID": "04_GWRegression.html#обычная-регрессия",
    "href": "04_GWRegression.html#обычная-регрессия",
    "title": "Географически взвешенная регрессия",
    "section": "Обычная регрессия",
    "text": "Обычная регрессия\n\nКоэффициент детерминации \\(R^2 = 0.1483\\). Регрессионная модель:\n\\[\n\\texttt{price} = 2319.2 +421.8~\\texttt{rooms}\n\\]"
  },
  {
    "objectID": "04_GWRegression.html#модель-гвр",
    "href": "04_GWRegression.html#модель-гвр",
    "title": "Географически взвешенная регрессия",
    "section": "Модель ГВР",
    "text": "Модель ГВР\nВ случае модели ГВР получается множество коэффициентов регрессии. По ним можно узнать статистику\n              Min.   1st Qu. Median  3rd Qu. Max.\n   Intercept  198.56 1785.17 2054.43 2361.79 3485.2\n   rooms     -409.97  471.77  524.01  650.52 1299.1\n   \n   Kernel function: gaussian \n   Fixed bandwidth: 1000 \n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used\nКоэффициент детерминации \\(R^2 = 0.367\\)."
  },
  {
    "objectID": "04_GWRegression.html#коэффициенты-гвр",
    "href": "04_GWRegression.html#коэффициенты-гвр",
    "title": "Географически взвешенная регрессия",
    "section": "Коэффициенты ГВР",
    "text": "Коэффициенты ГВР\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nПространственная картина распределения коэффициентов регрессии подтверждает гипотезу о гетерогенности.\n\n\n\nСамсонов Т. Е. Пространственная статистика: курс лекций"
  },
  {
    "objectID": "05_PointPatterns_slides.html#точечный-паттерн",
    "href": "05_PointPatterns_slides.html#точечный-паттерн",
    "title": "Точечные процессы",
    "section": "Точечный паттерн",
    "text": "Точечный паттерн\nТочечный паттерн (point pattern) представляет собой множество точек в \\(\\mathbb{R}^2\\), обозначаемое малой жирной буквой:\n\\[\\mathbf{x} = \\{x_1, x_2,...x_n\\}\\] - Количество точек \\(n = n(\\mathbf{x})\\) может быть любым неотрицательным числом\n\nМножество является неупорядоченным (индексы чисто условны)\nДопускаются дубликаты (совпадающие точки), однако большинство методов рассчитаны на то, что дубликатов в множестве нет."
  },
  {
    "objectID": "05_PointPatterns_slides.html#точечный-паттерн-1",
    "href": "05_PointPatterns_slides.html#точечный-паттерн-1",
    "title": "Точечные процессы",
    "section": "Точечный паттерн",
    "text": "Точечный паттерн\nЕсли \\(\\mathbf{x}\\) представляет точечный паттерн и \\(B\\) — это некий регион, то \\(\\mathbf{x} \\cap B\\) есть подмножество \\(\\mathbf{x}\\), состоящее из точек, попадающих в \\(B\\):\n\n:scale 40%В данном случае количество точек, попадающих в \\(B\\), равняется \\(n = n(\\mathbf{x} \\cap B)\\)"
  },
  {
    "objectID": "05_PointPatterns_slides.html#точечные-процессы",
    "href": "05_PointPatterns_slides.html#точечные-процессы",
    "title": "Точечные процессы",
    "section": "Точечные процессы",
    "text": "Точечные процессы\n\n__ Точечным процессом__ называется случайный процесс, реализациями которого являются точечные паттерны\n\nКонечный точечный процесс (finite point process) — это точечный процесс, каждая реализация которого представляет собой точечный паттерн с конечным числом точек. При этом для любой области \\(B\\) количество точек \\(\\mathbf{x} \\cap B\\) представляет собой случайную величину с определимыми параметрами.\nЛокально конечный точечный процесс имеет конечное число точек в любой ограниченной области \\(B\\) (более мягкое утверждение). Реализацией такого процесса является локально конечный точечный паттерн."
  },
  {
    "objectID": "05_PointPatterns_slides.html#равномерно-случайные-точки",
    "href": "05_PointPatterns_slides.html#равномерно-случайные-точки",
    "title": "Точечные процессы",
    "section": "Равномерно случайные точки",
    "text": "Равномерно случайные точки\nПростейшим точечным процессом является процесс \\(U = (U_1, U_2)\\), каждая реализация которого включает одну точку \\(u = (u_1, u_2)\\).\nСлучайная точка будет равномерно распределена в пространственной области \\(W\\), если ее координаты \\((U_1, U_2)\\) имеют совместную плотность распределения, которая постоянна в пределах \\(W\\) и равна нулю за ее пределами.\nПоскольку интеграл плотности распределения равен 1, величина постоянной будет равна \\(1/|W|\\):\n\\[f(u_1, u_2) = \\begin{cases}\n  1/|W|,~\\text{если}~(u_1, u_2) \\in W\\\\\n  0, ~\\text{в противном случае}\n\\end{cases}\\]"
  },
  {
    "objectID": "05_PointPatterns_slides.html#равномерно-случайные-точки-1",
    "href": "05_PointPatterns_slides.html#равномерно-случайные-точки-1",
    "title": "Точечные процессы",
    "section": "Равномерно случайные точки",
    "text": "Равномерно случайные точки\nЕсли \\(B\\) представляет собой тестовую область в \\(W\\), то вероятность того, что точка \\(U\\) попадет в \\(B\\), будет равна:\n\\[\\mathbb{P}\\{U \\in B \\} = \\int_B f(u_1, u_2) du_1 du_2 = \\\\ = \\frac{1}{|W|} \\int_B 1 du_1 du_2 = \\frac{|B|}{|W|}\\] - эта вероятность равна доле площади \\(B\\) в \\(W\\)\n\nвероятность зависит только от площади, и не зависит от положения и формы области \\(B\\)"
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nОднородный пуассоновский точечный процесс (homogeneous Poisson point process), или абсолютная пространственная случайность (complete spatial randomness — CSR) характеризуется следующими свойствами:\n\nгомогенность: размещение точек не имеет пространственных закономерностей\nнезависимость: результат реализации процесса в одной области не оказывает влияние на результат реализации в других областях\n\n\nBaddeley et. al., 2016"
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-1",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-1",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nОднородность (гомогенность) означает, что ожидаемое количество точек, попадающих в регион \\(B\\) должно быть пропорционально его площади:\n\\[\\operatorname E[n(\\mathbf{X} \\cap B)] = \\lambda |B|\\] Параметр \\(\\lambda\\) представляет собой среднее количество точек на единицу площади — интенсивность точечного процесса.\n\nВ отличие от биномиального процесса, полностью случайный (Пуассоновский) процесс характеризуется случайным количеством точек."
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-2",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-2",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nПространственная независимость означает, что количества точек в двух неперекрывающихся областях \\(A\\) и \\(B\\) являются независимыми случайными переменными:\n\\[n(\\mathbf{X} \\cap A) \\not\\sim n(\\mathbf{X} \\cap B),~A \\cap B = \\emptyset\\] &gt; Для биномиального процесса условие независимости не выполняется, поскольку известно общее количество точек. Если в область \\(A\\) попало \\(k\\) точек, то в область \\(B\\) не может попасть более чем \\(n-k\\) точек, что нарушает условие независимости распределений.\nПредположение о независимости выполняется для любых непересекающихся регионов \\(A\\) и \\(B\\) и для любого числа этих регионов"
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-4",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-4",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nУпорядоченность (orderliness): при стремлении площади области к нулю, вероятность нахождения в этой области более одной точки, деленная на площадь, также стремится к нулю\n\n:scale 50%"
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-5",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-5",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nЕсли реализации отвечают условию независимости и вероятность нахождения более одной точки в бесконечно малом квадрате пренебрежимо мала, то случайную величину \\(n(\\mathbf{X} \\cap B)\\) можно рассматривать как количество «успехов» в большом числе независимых испытаний, каждое из которых имеет малую вероятность успеха.\nЭто означает, что \\(n(\\mathbf{X} \\cap B)\\) подчиняется распределению Пуассона, которое характеризует частоту редких событий.\nВ соответствии с этим законом, вероятность получить \\(k\\) редких событий равна\n\\[\\mathbb{P}\\{N = k\\} = e^{-\\mu} \\frac{\\mu^k}{k!}\\color{grey}{,~k = 0, 1, 2, ...}\\]\nВеличина \\(\\mu\\) представляет собой математическое ожидание распределения Пуассона."
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-6",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-6",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\n\\[\\mathbb{P}\\{N = k\\} = e^{-\\mu} \\frac{\\mu^k}{k!}\\color{grey}{,~k = 0, 1, 2, ...}\\]\nВеличина \\(\\mu\\) представляет собой математическое ожидание распределения Пуассона.\n\nДисперсия распределения Пуассона равна его математическому ожиданию\n\nПоскольку, как мы показали ранее, ожидаемое количество точек в регионе \\(B\\) равняется \\(\\operatorname E[n(\\mathbf{X} \\cap B)] = \\lambda |B|\\), можно сделать вывод, что случайная величина \\(n(\\mathbf{X} \\cap B)\\) имеет распределение Пуассона с математическим ожиданием:\n\\[\\mu = \\lambda |B|\\]"
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-7",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-7",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nПуассоновский процесс определяется следующими параметрами:\n\nоднородность: количество \\(n(\\mathbf{X} \\cap B)\\) случайных точек, попадающих в выборочную область \\(B\\) характеризуется мат. ожиданием \\(\\mathbb{E}n(\\mathbf{X} \\cap B) = \\lambda |B|\\);\nнезависимость: для неперекрывающихся выборочных областей \\(B_1, B_2, ..., B_k\\), количества \\(n(\\mathbf{X} \\cap B_1), ..., n(\\mathbf{X} \\cap B_k)\\) предствляют собой независимые случайные величины;\nраспределение Пуассона: число \\(n(\\mathbf{X} \\cap B)\\) случайных точек, попадающих в выборочную область \\(B\\) распределено по закону Пуассона."
  },
  {
    "objectID": "05_PointPatterns_slides.html#симуляция-пуассоновского-процесса",
    "href": "05_PointPatterns_slides.html#симуляция-пуассоновского-процесса",
    "title": "Точечные процессы",
    "section": "Симуляция Пуассоновского процесса",
    "text": "Симуляция Пуассоновского процесса\nПусть дана область \\(B = [x_{min}, x_{max}] \\times [y_{min}, y_{max}]\\) и интенсивность точечного процесса \\(\\lambda\\).\n\nСгенерировать случайное число \\(N\\), имеющее распределение Пуассона с параметром \\(\\mu = \\lambda |B|\\).\nСгенерировать \\(N\\) координат \\(X\\), имеющих равномерное распределение на промежутке \\([x_{min}, x_{max}]\\).\nСгенерировать \\(N\\) координат \\(Y\\), имеющих равномерное распределение на промежутке \\([y_{min}, y_{max}]\\).\n\n\nВероятность получить 0 точек также существует и равна \\(\\mathbb{P}\\{N = 0\\} = e^{-\\mu} \\frac{\\mu^0}{0!} = e^{-\\lambda |B|}\\)"
  },
  {
    "objectID": "05_PointPatterns_slides.html#неоднородный-пуассоновский-процесс",
    "href": "05_PointPatterns_slides.html#неоднородный-пуассоновский-процесс",
    "title": "Точечные процессы",
    "section": "Неоднородный пуассоновский процесс",
    "text": "Неоднородный пуассоновский процесс\nОпределяется следующими параметрами:\n\nфункция интенсивности: количество \\(n(\\mathbf{X} \\cap B)\\) случайных точек, попадающих в выборочную область \\(B\\) характеризуется мат. ожиданием \\(\\mathbb{E}n(\\mathbf{X} \\cap B) = \\int_B \\lambda(u) du = \\mu\\), где \\(\\lambda(u)\\) есть пространственная функция интенсивности;\nнезависимость: для неперекрывающихся выборочных областей \\(B_1, B_2, ..., B_k\\), количества \\(n(\\mathbf{X} \\cap B_1), ..., n(\\mathbf{X} \\cap B_k)\\) предствляют собой независимые случайные величины;\nраспределение Пуассона: число \\(n(\\mathbf{B} \\cap B)\\) случайных точек, попадающих в выборочную область \\(B\\) распределено по закону Пуассона."
  },
  {
    "objectID": "05_PointPatterns_slides.html#неоднородный-пуассоновский-процесс-1",
    "href": "05_PointPatterns_slides.html#неоднородный-пуассоновский-процесс-1",
    "title": "Точечные процессы",
    "section": "Неоднородный пуассоновский процесс",
    "text": "Неоднородный пуассоновский процесс\nДанные параметры отличаются следующими свойствами:\n\nфункция плотности \\(\\lambda(u)\\) определяет общее количество точек и их пространственное распределение;\nникаких ограничений на функцию \\(\\lambda(u)\\) не накладывается, вследствие этого модель неоднородного Пуассоновского процесса является достаточно общей;\nсвойства условности, прореживаемости и суперпозиции справедливы также и для неоднородного пуассоновского процесса;"
  },
  {
    "objectID": "05_PointPatterns_slides.html#симуляция-неоднородного-пуассоновского-процесса",
    "href": "05_PointPatterns_slides.html#симуляция-неоднородного-пуассоновского-процесса",
    "title": "Точечные процессы",
    "section": "Симуляция неоднородного пуассоновского процесса",
    "text": "Симуляция неоднородного пуассоновского процесса\nМетод Льюиса-Шедлера (Lewis-Shedler thinning):\n\nГенерируется однородный Пуассоновской процесс с интенсивностью \\(M = \\max_L\\big[\\lambda(u)\\big]\\).\nОсуществляется случайное прореживание (исключение) точек с вероятностью сохранения точки \\(p(u) = \\lambda(u) / M\\), пропорциональной функции интенсивности.\n\nЧтобы понять, будет ли точка исключена, генерируется случайное число 0 или 1, имеющее распределение Бернулли с вероятностью положительного исхода \\(p = p(u)\\). Это можно сделать с помощью функции rbinom(1, 1, p)"
  },
  {
    "objectID": "05_PointPatterns_slides.html#симуляция-неоднородного-пуассоновского-процесса-1",
    "href": "05_PointPatterns_slides.html#симуляция-неоднородного-пуассоновского-процесса-1",
    "title": "Точечные процессы",
    "section": "Симуляция неоднородного пуассоновского процесса",
    "text": "Симуляция неоднородного пуассоновского процесса\n\\[\\lambda(x,y) = x + y^2\\]"
  },
  {
    "objectID": "05_PointPatterns_slides.html#процесс-кокса-cox-process",
    "href": "05_PointPatterns_slides.html#процесс-кокса-cox-process",
    "title": "Точечные процессы",
    "section": "Процесс Кокса (Cox process)",
    "text": "Процесс Кокса (Cox process)\nПроцесс Кокса определяется как Пуассоновский процесс со случайной функцией интенсивности \\(\\Lambda(u)\\), которая называется порождающей интенсивностью\n\nBaddeley et. al., 2016Слева — реализация случайной функции \\(\\Lambda(u)\\). По центру — реализация Пуассоновского точечного процесса с интенсивностью \\(\\Lambda(u)\\)."
  },
  {
    "objectID": "05_PointPatterns_slides.html#процесс-кокса-cox-process-1",
    "href": "05_PointPatterns_slides.html#процесс-кокса-cox-process-1",
    "title": "Точечные процессы",
    "section": "Процесс Кокса (Cox process)",
    "text": "Процесс Кокса (Cox process)\n\nCмешанный Пуассоновский процесс: однородный Пуассоновский процесс, порождаемый постоянной случайной величиной \\(\\Lambda\\). Интенсивность процесса равна \\(\\lambda = \\mathbb E\\Lambda\\).\nЛогнормальный процесс Кокса: процесс Кокса с порождающей интенсивностью, равной \\(\\Lambda(u) = \\exp\\big[G(u)\\big]\\), где \\(G(u)\\) — Гауссовское случайное поле.\n\nДля гауссовского случайного поля в каждой точке \\(u_i\\) случайная величина \\(G(u_i)\\) имеет нормальное распределение, для пары точек \\(u\\) и \\(v\\) пара величин \\(\\big(G(u), G(v)\\big)\\) имеет двумерное нормальное распределение. Аналогично и для произвольного числа точек."
  },
  {
    "objectID": "05_PointPatterns_slides.html#процесс-кокса-cox-process-2",
    "href": "05_PointPatterns_slides.html#процесс-кокса-cox-process-2",
    "title": "Точечные процессы",
    "section": "Процесс Кокса (Cox process)",
    "text": "Процесс Кокса (Cox process)\nНезависимые реализации логнормального процесса Кокса:\n\nBaddeley et. al., 2016"
  },
  {
    "objectID": "05_PointPatterns_slides.html#кластерные-процессы",
    "href": "05_PointPatterns_slides.html#кластерные-процессы",
    "title": "Точечные процессы",
    "section": "Кластерные процессы",
    "text": "Кластерные процессы\n\nГенерируется «родительский» точечный процесс \\(\\mathbf{Y}\\).\nКаждая точка родительского процесса \\(y_i\\) порождает случайный точечный паттерн «потомков» \\(x_{ij}\\)\n\n\nBaddeley et. al., 2016"
  },
  {
    "objectID": "05_PointPatterns_slides.html#кластерные-процессы-1",
    "href": "05_PointPatterns_slides.html#кластерные-процессы-1",
    "title": "Точечные процессы",
    "section": "Кластерные процессы",
    "text": "Кластерные процессы\n— Наблюдаются только точки потомков (каждая родительская точка замещается ее потомками).\n— Множество точек \\(x_{ij}\\) формирует реализацию кластерного точечного процесса \\(\\mathbf{X}\\).\n\nBaddeley et. al., 2016"
  },
  {
    "objectID": "05_PointPatterns_slides.html#кластерные-процессы-2",
    "href": "05_PointPatterns_slides.html#кластерные-процессы-2",
    "title": "Точечные процессы",
    "section": "Кластерные процессы",
    "text": "Кластерные процессы\nВозможные свойства кластерных процессов:\n\n(CLP1) пуассоновские родители: родительские точки являются реализацией Пуассоновского процесса.\n(CLP2) независимые кластеры: кластеры независимы друг от друга.\n(CLP3) идентично распределенные кластеры: если совместить разные кластеры, то они будут иметь одно распределение.\n(CLP4) независимые потомки: потомки внутри каждого кластера независимы и одинаково распределены.\n\nПроцессы, отвечающие требованиям (CLP1)—(CLP4) носят название процессов Неймана-Скотта (Neyman-Scott)."
  },
  {
    "objectID": "05_PointPatterns_slides.html#кластерные-процессы-3",
    "href": "05_PointPatterns_slides.html#кластерные-процессы-3",
    "title": "Точечные процессы",
    "section": "Кластерные процессы",
    "text": "Кластерные процессы\n\n(CLP5) пуассоновское количество потомков: для каждой родительской точки количество потомков есть пуассоновская случайная величина.\n(CLP6) изотропные кластеры: плотность распределения потомков зависит только от расстояния до родительской точки."
  },
  {
    "objectID": "05_PointPatterns_slides.html#кластерные-процессы-4",
    "href": "05_PointPatterns_slides.html#кластерные-процессы-4",
    "title": "Точечные процессы",
    "section": "Кластерные процессы",
    "text": "Кластерные процессы\n\nПроцесс Матерна \\((\\kappa, \\mu, r)\\): процесс \\(Y\\) имеет интенсивность \\(κ\\), каждый родитель имеет \\(Π(μ)\\) потомков, случайно распределенных в радиусе \\(r\\)\nПроцесс Томаса \\((\\kappa, \\mu, \\sigma)\\): процесс \\(Y\\) имеет интенсивность κ, каждый родитель имеет \\(Π(μ)\\) потомков, смещенных на расстояние, подчиняющееся распределению \\(N(0,\\sigma^2)\\)"
  },
  {
    "objectID": "05_PointPatterns_slides.html#кластерные-процессы-5",
    "href": "05_PointPatterns_slides.html#кластерные-процессы-5",
    "title": "Точечные процессы",
    "section": "Кластерные процессы",
    "text": "Кластерные процессы\nРеализации процесса Матерна в квадрате \\([0, 1] \\times [0, 1]\\) с интенсивностью родителей \\(\\kappa = 8\\), средним количеством потомков \\(\\mu = 5\\) и радиусом кластера \\(R = 0.1\\):\n\nBaddeley et. al., 2016"
  },
  {
    "objectID": "05_PointPatterns_slides.html#регулярные-процессы",
    "href": "05_PointPatterns_slides.html#регулярные-процессы",
    "title": "Точечные процессы",
    "section": "Регулярные процессы",
    "text": "Регулярные процессы\nТочки не могут располагаться на расстоянии ближе чем \\(r\\) — расстояния ингибиции (отталкивания).\n\nПоследовательные модели: точки генерируются последовательно согласно Пуассоновскому распредедению (координаты равномерно распределены). Каждая последующая точка сохраняется, только если она находится на расстоянии не ближе, чем \\(r\\).\nЗависимое прореживание: генерируется Пуассоновский процесс. После этого удаляются точки, расположенные на расстоянии меньшем \\(r\\). Пары близко расположенных точек аннигилируют (процесс Матерна I). Либо точки маркируются случайным «временем прибытия» и удаляется точка, имеющая более позднее время прибытия (процесс Матерна II)."
  },
  {
    "objectID": "05_PointPatterns_slides.html#регулярные-процессы-1",
    "href": "05_PointPatterns_slides.html#регулярные-процессы-1",
    "title": "Точечные процессы",
    "section": "Регулярные процессы",
    "text": "Регулярные процессы\nПоследовательная модель:\n\n:scale 60%"
  },
  {
    "objectID": "05_PointPatterns_slides.html#регулярные-процессы-2",
    "href": "05_PointPatterns_slides.html#регулярные-процессы-2",
    "title": "Точечные процессы",
    "section": "Регулярные процессы",
    "text": "Регулярные процессы\nПроцесс Матерна I:\n\nBaddeley et. al., 2016"
  },
  {
    "objectID": "05_PointPatterns_slides.html#регулярные-процессы-3",
    "href": "05_PointPatterns_slides.html#регулярные-процессы-3",
    "title": "Точечные процессы",
    "section": "Регулярные процессы",
    "text": "Регулярные процессы\nПроцесс Матерна II:\n\n\nBaddeley et. al., 2016\n\nСамсонов Т. Е. Пространственная статистика: курс лекций"
  },
  {
    "objectID": "05_PointPatterns_slides.html#биномиальный-точечный-процесс",
    "href": "05_PointPatterns_slides.html#биномиальный-точечный-процесс",
    "title": "Точечные процессы",
    "section": "Биномиальный точечный процесс",
    "text": "Биномиальный точечный процесс\nБиномиальным называется точечный процесс \\(\\mathbf{X} = \\{X_1,..., X_n\\}\\), реализации которого содержат \\(n\\) точек.\n\nBaddeley et. al., 2016Чтобы точки были распределены равномерно по пространству, необходимо выполнение двух условий:\n\n\\(X_1,...,X_n\\) представляют собой независимые случайные величины\nКаждая из этих величин равномерно распределена в пределах \\(W\\)."
  },
  {
    "objectID": "05_PointPatterns_slides.html#биномиальный-точечный-процесс-1",
    "href": "05_PointPatterns_slides.html#биномиальный-точечный-процесс-1",
    "title": "Точечные процессы",
    "section": "Биномиальный точечный процесс",
    "text": "Биномиальный точечный процесс\nЕсли \\(B\\) представляет собой тестовую область, то количество \\(n(\\mathbf{X} \\cap B)\\) случайных точек, попавших в \\(B\\), будет равняться количеству индексов \\(i\\) таких, что \\(X_i \\in B\\).\nЧтобы определить вероятностное распределение \\(n(\\mathbf{X} \\cap B)\\), рассмотрим эту величину как количество успешных исходов в \\(n\\) независимых испытаниях. Будем считать «успехом» исход, при котором случайная точка \\(X_i\\) попадает в \\(B\\).\nЕсли испытания независимы и равномерно распределены, то вероятность успеха равна \\(p = |B| / |W|\\) и величина \\(n(\\mathbf{X} \\cap B)\\) имеет биномиальный закон распределения:\n\\[\\mathbb{P}\\{n(\\mathbf{X} \\cap B) = k\\} =\n  \\left(\n    \\begin{array}{c}\n      n \\\\\n      k\n    \\end{array}\n  \\right) p^k (1-p)^{n-k}\\color{grey}{, k = 0, 1, ..., n}\\]\nБиномиальный коэффициент равен \\(\\left(\\begin{array}{c} n \\\\ k \\end{array} \\right) = \\frac{n!}{(n-k)!~k!}\\)"
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-3",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-3",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nОдним из следствий независимости является тот факт, что количество точек, подсчитанное по регулярной сетке квадратов, также даст совокупность независимых величин (для любого размера сетки):\n\nBaddeley et. al., 2016"
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-8",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-8",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nСвойства пуассоновского процесса:\n\nусловность (conditional): в любой области \\(B\\) точки процесса независимо и равномерно распределены;\nпрореживаемость (thinning): при случайном прореживании (отборе точек) пуассоновского точечного паттерна с интенсивностью \\(\\lambda\\) результирующий паттерн будет соответствовать Пуассоновскому процессу с интенсивностью \\(p\\lambda\\), где \\(p\\) — вероятность сохранения точки (процент отбора);\n\n\n\nBaddeley et. al., 2016"
  },
  {
    "objectID": "05_PointPatterns_slides.html#пуассоновский-процесс-9",
    "href": "05_PointPatterns_slides.html#пуассоновский-процесс-9",
    "title": "Точечные процессы",
    "section": "Пуассоновский процесс",
    "text": "Пуассоновский процесс\nСвойства пуассоновского процесса:\n\nсуперпозиция (superposition): сумма двух независимых гомогенных случайных точечных процессов \\(Z = X \\cup Y\\) с интенсивностями \\(\\lambda_X\\) и \\(\\lambda_Y\\) является гомогенным Пуассоновским процессом с интенсивностью \\(\\lambda_Z = \\lambda_X + \\lambda_Y\\)\n\n\n\nBaddeley et. al., 2016"
  }
]